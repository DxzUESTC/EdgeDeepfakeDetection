2025-08-31 12:31:10 - [INFO] - 日志文件保存位置: D:\09_Project\EdgeDeepfakeDetection\experiments\server\kd_train_log_20250831_123110.txt
2025-08-31 12:31:10 - [INFO] - ============================================================
2025-08-31 12:31:10 - [INFO] - 知识蒸馏训练 - SwinT -> MobileNetV3
2025-08-31 12:31:10 - [INFO] - ============================================================
2025-08-31 12:31:10 - [INFO] - 训练配置:
2025-08-31 12:31:10 - [INFO] -   base_dir: D:\09_Project\EdgeDeepfakeDetection
2025-08-31 12:31:10 - [INFO] -   log_dir: D:\09_Project\EdgeDeepfakeDetection\experiments\server
2025-08-31 12:31:10 - [INFO] -   model_save_dir: D:\09_Project\EdgeDeepfakeDetection\models\server\kd_mobilenetv3
2025-08-31 12:31:10 - [INFO] -   teacher_model_path: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth
2025-08-31 12:31:10 - [INFO] -   random_seed: 42
2025-08-31 12:31:10 - [INFO] -   batch_size: 64
2025-08-31 12:31:10 - [INFO] -   num_workers: 4
2025-08-31 12:31:10 - [INFO] -   num_epochs: 40
2025-08-31 12:31:10 - [INFO] -   patience: 8
2025-08-31 12:31:10 - [INFO] -   learning_rate: 0.0005
2025-08-31 12:31:10 - [INFO] -   weight_decay: 0.0001
2025-08-31 12:31:10 - [INFO] -   temperature: 4.0
2025-08-31 12:31:10 - [INFO] -   alpha: 0.7
2025-08-31 12:31:10 - [INFO] -   beta: 0.3
2025-08-31 12:31:10 - [INFO] -   add_train_noise: False
2025-08-31 12:31:10 - [INFO] -   add_test_noise: True
2025-08-31 12:31:10 - [INFO] - 正在加载数据集...
2025-08-31 12:31:10 - [INFO] - 训练集大小: 70000
2025-08-31 12:31:10 - [INFO] - 验证集大小: 15000
2025-08-31 12:31:10 - [INFO] - 训练集标签分布 - 真实: 35000, 伪造: 35000
2025-08-31 12:31:10 - [INFO] - 验证集标签分布 - 真实: 7500, 伪造: 7500
2025-08-31 12:31:10 - [INFO] - 设置num_workers为: 0 (避免多进程问题)
2025-08-31 12:31:10 - [INFO] - 训练集大小: 70000
2025-08-31 12:31:10 - [INFO] - 验证集大小: 15000
2025-08-31 12:31:10 - [INFO] - 批次大小: 64
2025-08-31 12:31:11 - [INFO] - 使用设备: cuda
2025-08-31 12:31:11 - [INFO] - CUDA设备信息: NVIDIA GeForce RTX 3070 Ti Laptop GPU
2025-08-31 12:31:11 - [INFO] - GPU内存: 8.0 GB
2025-08-31 12:31:11 - [INFO] - Windows CUDA优化已启用
2025-08-31 12:31:11 - [INFO] - 正在加载教师模型: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth
2025-08-31 12:31:11 - [INFO] - ✓ 教师模型加载完成
2025-08-31 12:31:11 - [INFO] - 正在创建学生模型(MobileNetV3)...
2025-08-31 12:31:11 - [INFO] - ✓ 学生模型创建完成
2025-08-31 12:31:11 - [INFO] - 蒸馏参数: α=0.7, β=0.3, T=4.0
2025-08-31 12:31:11 - [INFO] - 开始知识蒸馏训练...
2025-08-31 12:31:11 - [INFO] - 总轮数: 40, 早停耐心: 8
2025-08-31 12:42:03 - [INFO] - Epoch 1/40:
2025-08-31 12:42:03 - [INFO] -   训练 - 损失: 0.4539 (硬: 0.4289, 软: 0.4647), 准确率: 79.64%
2025-08-31 12:42:03 - [INFO] -   验证 - 损失: 0.4156, 准确率: 83.40%, AUC: 0.9111
2025-08-31 12:42:03 - [INFO] -   学习率: 0.000499, 时间: 652.3s
2025-08-31 12:42:03 - [INFO] -   ✓ 新的最佳模型已保存! 验证准确率: 83.40%, AUC: 0.9111
2025-08-31 12:42:03 - [INFO] - --------------------------------------------------
2025-08-31 12:52:16 - [INFO] - Epoch 2/40:
2025-08-31 12:52:16 - [INFO] -   训练 - 损失: 0.3365 (硬: 0.3394, 软: 0.3353), 准确率: 85.29%
2025-08-31 12:52:16 - [INFO] -   验证 - 损失: 0.4034, 准确率: 81.31%, AUC: 0.9395
2025-08-31 12:52:16 - [INFO] -   学习率: 0.000497, 时间: 612.2s
2025-08-31 12:52:16 - [INFO] -   未改善 (1/8)
2025-08-31 12:52:16 - [INFO] - --------------------------------------------------
2025-08-31 13:02:23 - [INFO] - Epoch 3/40:
2025-08-31 13:02:23 - [INFO] -   训练 - 损失: 0.3085 (硬: 0.3159, 软: 0.3053), 准确率: 86.57%
2025-08-31 13:02:23 - [INFO] -   验证 - 损失: 0.3434, 准确率: 85.58%, AUC: 0.9380
2025-08-31 13:02:23 - [INFO] -   学习率: 0.000493, 时间: 607.2s
2025-08-31 13:02:23 - [INFO] -   ✓ 新的最佳模型已保存! 验证准确率: 85.58%, AUC: 0.9380
2025-08-31 13:02:23 - [INFO] - --------------------------------------------------
2025-08-31 13:12:35 - [INFO] - Epoch 4/40:
2025-08-31 13:12:35 - [INFO] -   训练 - 损失: 0.2924 (硬: 0.3027, 软: 0.2879), 准确率: 87.19%
2025-08-31 13:12:35 - [INFO] -   验证 - 损失: 0.2518, 准确率: 90.15%, AUC: 0.9623
2025-08-31 13:12:35 - [INFO] -   学习率: 0.000488, 时间: 611.9s
2025-08-31 13:12:35 - [INFO] -   ✓ 新的最佳模型已保存! 验证准确率: 90.15%, AUC: 0.9623
2025-08-31 13:12:35 - [INFO] - --------------------------------------------------
2025-08-31 13:22:46 - [INFO] - Epoch 5/40:
2025-08-31 13:22:46 - [INFO] -   训练 - 损失: 0.2852 (硬: 0.2938, 软: 0.2815), 准确率: 87.78%
2025-08-31 13:22:46 - [INFO] -   验证 - 损失: 0.3350, 准确率: 85.38%, AUC: 0.9627
2025-08-31 13:22:46 - [INFO] -   学习率: 0.000481, 时间: 611.4s
2025-08-31 13:22:46 - [INFO] -   未改善 (1/8)
2025-08-31 13:22:46 - [INFO] -   检查点已保存: D:\09_Project\EdgeDeepfakeDetection\models\server\kd_mobilenetv3\kd_mobilenetv3_epoch_5.pth
2025-08-31 13:22:46 - [INFO] - --------------------------------------------------
2025-08-31 13:32:57 - [INFO] - Epoch 6/40:
2025-08-31 13:32:57 - [INFO] -   训练 - 损失: 0.2760 (硬: 0.2840, 软: 0.2725), 准确率: 88.20%
2025-08-31 13:32:57 - [INFO] -   验证 - 损失: 0.2461, 准确率: 90.24%, AUC: 0.9623
2025-08-31 13:32:57 - [INFO] -   学习率: 0.000473, 时间: 611.0s
2025-08-31 13:32:57 - [INFO] -   ✓ 新的最佳模型已保存! 验证准确率: 90.24%, AUC: 0.9623
2025-08-31 13:32:57 - [INFO] - --------------------------------------------------
2025-08-31 13:43:10 - [INFO] - Epoch 7/40:
2025-08-31 13:43:10 - [INFO] -   训练 - 损失: 0.2699 (硬: 0.2854, 软: 0.2633), 准确率: 87.87%
2025-08-31 13:43:10 - [INFO] -   验证 - 损失: 0.2644, 准确率: 88.69%, AUC: 0.9611
2025-08-31 13:43:10 - [INFO] -   学习率: 0.000463, 时间: 613.0s
2025-08-31 13:43:10 - [INFO] -   未改善 (1/8)
2025-08-31 13:43:10 - [INFO] - --------------------------------------------------
2025-08-31 13:53:23 - [INFO] - Epoch 8/40:
2025-08-31 13:53:23 - [INFO] -   训练 - 损失: 0.2640 (硬: 0.2807, 软: 0.2568), 准确率: 88.18%
2025-08-31 13:53:23 - [INFO] -   验证 - 损失: 0.2960, 准确率: 86.82%, AUC: 0.9592
2025-08-31 13:53:23 - [INFO] -   学习率: 0.000452, 时间: 612.2s
2025-08-31 13:53:23 - [INFO] -   未改善 (2/8)
2025-08-31 13:53:23 - [INFO] - --------------------------------------------------
2025-08-31 14:03:36 - [INFO] - Epoch 9/40:
2025-08-31 14:03:36 - [INFO] -   训练 - 损失: 0.2581 (硬: 0.2772, 软: 0.2500), 准确率: 88.26%
2025-08-31 14:03:36 - [INFO] -   验证 - 损失: 0.2654, 准确率: 89.77%, AUC: 0.9602
2025-08-31 14:03:36 - [INFO] -   学习率: 0.000440, 时间: 613.0s
2025-08-31 14:03:36 - [INFO] -   未改善 (3/8)
2025-08-31 14:03:36 - [INFO] - --------------------------------------------------
2025-08-31 14:13:46 - [INFO] - Epoch 10/40:
2025-08-31 14:13:46 - [INFO] -   训练 - 损失: 0.2509 (硬: 0.2719, 软: 0.2419), 准确率: 88.45%
2025-08-31 14:13:46 - [INFO] -   验证 - 损失: 0.2818, 准确率: 88.21%, AUC: 0.9625
2025-08-31 14:13:46 - [INFO] -   学习率: 0.000427, 时间: 609.9s
2025-08-31 14:13:46 - [INFO] -   未改善 (4/8)
2025-08-31 14:13:46 - [INFO] -   检查点已保存: D:\09_Project\EdgeDeepfakeDetection\models\server\kd_mobilenetv3\kd_mobilenetv3_epoch_10.pth
2025-08-31 14:13:46 - [INFO] - --------------------------------------------------
2025-08-31 14:23:56 - [INFO] - Epoch 11/40:
2025-08-31 14:23:56 - [INFO] -   训练 - 损失: 0.2467 (硬: 0.2673, 软: 0.2378), 准确率: 88.65%
2025-08-31 14:23:56 - [INFO] -   验证 - 损失: 0.2401, 准确率: 90.63%, AUC: 0.9651
2025-08-31 14:23:56 - [INFO] -   学习率: 0.000413, 时间: 610.8s
2025-08-31 14:23:56 - [INFO] -   ✓ 新的最佳模型已保存! 验证准确率: 90.63%, AUC: 0.9651
2025-08-31 14:23:56 - [INFO] - --------------------------------------------------
2025-08-31 14:34:06 - [INFO] - Epoch 12/40:
2025-08-31 14:34:06 - [INFO] -   训练 - 损失: 0.2450 (硬: 0.2630, 软: 0.2373), 准确率: 88.84%
2025-08-31 14:34:06 - [INFO] -   验证 - 损失: 0.2245, 准确率: 91.03%, AUC: 0.9644
2025-08-31 14:34:06 - [INFO] -   学习率: 0.000397, 时间: 610.0s
2025-08-31 14:34:06 - [INFO] -   ✓ 新的最佳模型已保存! 验证准确率: 91.03%, AUC: 0.9644
2025-08-31 14:34:06 - [INFO] - --------------------------------------------------
2025-08-31 14:44:27 - [INFO] - Epoch 13/40:
2025-08-31 14:44:27 - [INFO] -   训练 - 损失: 0.2422 (硬: 0.2616, 软: 0.2338), 准确率: 88.90%
2025-08-31 14:44:27 - [INFO] -   验证 - 损失: 0.3317, 准确率: 85.70%, AUC: 0.9624
2025-08-31 14:44:27 - [INFO] -   学习率: 0.000381, 时间: 620.9s
2025-08-31 14:44:27 - [INFO] -   未改善 (1/8)
2025-08-31 14:44:27 - [INFO] - --------------------------------------------------
2025-08-31 14:54:42 - [INFO] - Epoch 14/40:
2025-08-31 14:54:42 - [INFO] -   训练 - 损失: 0.2395 (硬: 0.2609, 软: 0.2303), 准确率: 88.81%
2025-08-31 14:54:42 - [INFO] -   验证 - 损失: 0.2151, 准确率: 92.23%, AUC: 0.9721
2025-08-31 14:54:42 - [INFO] -   学习率: 0.000364, 时间: 615.0s
2025-08-31 14:54:42 - [INFO] -   ✓ 新的最佳模型已保存! 验证准确率: 92.23%, AUC: 0.9721
2025-08-31 14:54:42 - [INFO] - --------------------------------------------------
2025-08-31 15:04:57 - [INFO] - Epoch 15/40:
2025-08-31 15:04:57 - [INFO] -   训练 - 损失: 0.2387 (硬: 0.2617, 软: 0.2289), 准确率: 88.62%
2025-08-31 15:04:57 - [INFO] -   验证 - 损失: 0.2395, 准确率: 90.13%, AUC: 0.9643
2025-08-31 15:04:57 - [INFO] -   学习率: 0.000346, 时间: 614.3s
2025-08-31 15:04:57 - [INFO] -   未改善 (1/8)
2025-08-31 15:04:57 - [INFO] -   检查点已保存: D:\09_Project\EdgeDeepfakeDetection\models\server\kd_mobilenetv3\kd_mobilenetv3_epoch_15.pth
2025-08-31 15:04:57 - [INFO] - --------------------------------------------------
2025-08-31 15:15:00 - [INFO] - Epoch 16/40:
2025-08-31 15:15:00 - [INFO] -   训练 - 损失: 0.2339 (硬: 0.2540, 软: 0.2253), 准确率: 89.04%
2025-08-31 15:15:00 - [INFO] -   验证 - 损失: 0.2297, 准确率: 90.91%, AUC: 0.9725
2025-08-31 15:15:00 - [INFO] -   学习率: 0.000328, 时间: 603.5s
2025-08-31 15:15:00 - [INFO] -   未改善 (2/8)
2025-08-31 15:15:00 - [INFO] - --------------------------------------------------
2025-08-31 15:25:13 - [INFO] - Epoch 17/40:
2025-08-31 15:25:13 - [INFO] -   训练 - 损失: 0.2295 (硬: 0.2544, 软: 0.2189), 准确率: 89.00%
2025-08-31 15:25:13 - [INFO] -   验证 - 损失: 0.1898, 准确率: 92.60%, AUC: 0.9755
2025-08-31 15:25:13 - [INFO] -   学习率: 0.000309, 时间: 613.1s
2025-08-31 15:25:13 - [INFO] -   ✓ 新的最佳模型已保存! 验证准确率: 92.60%, AUC: 0.9755
2025-08-31 15:25:13 - [INFO] - --------------------------------------------------
2025-08-31 15:35:27 - [INFO] - Epoch 18/40:
2025-08-31 15:35:27 - [INFO] -   训练 - 损失: 0.2286 (硬: 0.2549, 软: 0.2173), 准确率: 88.95%
2025-08-31 15:35:27 - [INFO] -   验证 - 损失: 0.1932, 准确率: 92.41%, AUC: 0.9745
2025-08-31 15:35:27 - [INFO] -   学习率: 0.000290, 时间: 613.5s
2025-08-31 15:35:27 - [INFO] -   未改善 (1/8)
2025-08-31 15:35:27 - [INFO] - --------------------------------------------------
2025-08-31 15:45:35 - [INFO] - Epoch 19/40:
2025-08-31 15:45:35 - [INFO] -   训练 - 损失: 0.2273 (硬: 0.2512, 软: 0.2171), 准确率: 89.09%
2025-08-31 15:45:35 - [INFO] -   验证 - 损失: 0.2655, 准确率: 88.25%, AUC: 0.9727
2025-08-31 15:45:35 - [INFO] -   学习率: 0.000270, 时间: 608.3s
2025-08-31 15:45:35 - [INFO] -   未改善 (2/8)
2025-08-31 15:45:35 - [INFO] - --------------------------------------------------
2025-08-31 15:56:01 - [INFO] - Epoch 20/40:
2025-08-31 15:56:01 - [INFO] -   训练 - 损失: 0.2234 (硬: 0.2503, 软: 0.2119), 准确率: 89.04%
2025-08-31 15:56:01 - [INFO] -   验证 - 损失: 0.2347, 准确率: 89.69%, AUC: 0.9672
2025-08-31 15:56:01 - [INFO] -   学习率: 0.000251, 时间: 626.1s
2025-08-31 15:56:01 - [INFO] -   未改善 (3/8)
2025-08-31 15:56:01 - [INFO] -   检查点已保存: D:\09_Project\EdgeDeepfakeDetection\models\server\kd_mobilenetv3\kd_mobilenetv3_epoch_20.pth
2025-08-31 15:56:01 - [INFO] - --------------------------------------------------
2025-08-31 16:06:25 - [INFO] - Epoch 21/40:
2025-08-31 16:06:25 - [INFO] -   训练 - 损失: 0.2206 (硬: 0.2462, 软: 0.2096), 准确率: 89.22%
2025-08-31 16:06:25 - [INFO] -   验证 - 损失: 0.2118, 准确率: 91.57%, AUC: 0.9700
2025-08-31 16:06:25 - [INFO] -   学习率: 0.000231, 时间: 623.9s
2025-08-31 16:06:25 - [INFO] -   未改善 (4/8)
2025-08-31 16:06:25 - [INFO] - --------------------------------------------------
2025-08-31 16:16:57 - [INFO] - Epoch 22/40:
2025-08-31 16:16:57 - [INFO] -   训练 - 损失: 0.2203 (硬: 0.2462, 软: 0.2092), 准确率: 89.01%
2025-08-31 16:16:57 - [INFO] -   验证 - 损失: 0.2410, 准确率: 89.36%, AUC: 0.9704
2025-08-31 16:16:57 - [INFO] -   学习率: 0.000211, 时间: 632.0s
2025-08-31 16:16:57 - [INFO] -   未改善 (5/8)
2025-08-31 16:16:57 - [INFO] - --------------------------------------------------
2025-08-31 16:27:15 - [INFO] - Epoch 23/40:
2025-08-31 16:27:15 - [INFO] -   训练 - 损失: 0.2143 (硬: 0.2443, 软: 0.2014), 准确率: 89.16%
2025-08-31 16:27:15 - [INFO] -   验证 - 损失: 0.2463, 准确率: 89.47%, AUC: 0.9724
2025-08-31 16:27:15 - [INFO] -   学习率: 0.000192, 时间: 617.5s
2025-08-31 16:27:15 - [INFO] -   未改善 (6/8)
2025-08-31 16:27:15 - [INFO] - --------------------------------------------------
2025-08-31 16:37:49 - [INFO] - Epoch 24/40:
2025-08-31 16:37:49 - [INFO] -   训练 - 损失: 0.2123 (硬: 0.2441, 软: 0.1986), 准确率: 89.07%
2025-08-31 16:37:49 - [INFO] -   验证 - 损失: 0.2124, 准确率: 91.06%, AUC: 0.9710
2025-08-31 16:37:49 - [INFO] -   学习率: 0.000173, 时间: 634.0s
2025-08-31 16:37:49 - [INFO] -   未改善 (7/8)
2025-08-31 16:37:49 - [INFO] - --------------------------------------------------
2025-08-31 16:48:37 - [INFO] - Epoch 25/40:
2025-08-31 16:48:37 - [INFO] -   训练 - 损失: 0.2147 (硬: 0.2419, 软: 0.2030), 准确率: 89.16%
2025-08-31 16:48:37 - [INFO] -   验证 - 损失: 0.2610, 准确率: 88.44%, AUC: 0.9709
2025-08-31 16:48:37 - [INFO] -   学习率: 0.000155, 时间: 648.4s
2025-08-31 16:48:37 - [INFO] -   未改善 (8/8)
2025-08-31 16:48:37 - [INFO] -   检查点已保存: D:\09_Project\EdgeDeepfakeDetection\models\server\kd_mobilenetv3\kd_mobilenetv3_epoch_25.pth
2025-08-31 16:48:37 - [INFO] - 
早停触发! 最佳验证准确率: 92.60%, AUC: 0.9755
2025-08-31 16:48:37 - [INFO] - 知识蒸馏训练完成!
2025-08-31 16:48:37 - [INFO] - 最佳模型保存路径: D:\09_Project\EdgeDeepfakeDetection\models\server\kd_mobilenetv3\kd_mobilenetv3_best.pth
2025-08-31 16:48:37 - [INFO] - 最佳验证准确率: 92.60%
2025-08-31 16:48:37 - [INFO] - 最佳验证AUC: 0.9755
2025-08-31 16:48:37 - [INFO] - 
============================================================
2025-08-31 16:48:37 - [INFO] - 知识蒸馏训练完成!
2025-08-31 16:48:37 - [INFO] - 最佳模型: D:\09_Project\EdgeDeepfakeDetection\models\server\kd_mobilenetv3\kd_mobilenetv3_best.pth
2025-08-31 16:48:37 - [INFO] - 最佳准确率: 92.60%
2025-08-31 16:48:37 - [INFO] - 最佳AUC: 0.9755
2025-08-31 16:48:37 - [INFO] - 日志文件: D:\09_Project\EdgeDeepfakeDetection\experiments\server\kd_train_log_20250831_123110.txt
2025-08-31 16:48:37 - [INFO] - ============================================================

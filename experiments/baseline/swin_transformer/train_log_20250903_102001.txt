2025-09-03 10:20:01 - [INFO] - 日志文件保存位置: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer\train_log_20250903_102001.txt
2025-09-03 10:20:01 - [INFO] - ================================================================================
2025-09-03 10:20:01 - [INFO] - Swin Transformer Tiny Deepfake Detection Training
2025-09-03 10:20:01 - [INFO] - 开始时间: 2025-09-03 10:20:01
2025-09-03 10:20:01 - [INFO] - ================================================================================
2025-09-03 10:20:01 - [INFO] - 路径配置:
2025-09-03 10:20:01 - [INFO] -   - 基础目录: D:\09_Project\EdgeDeepfakeDetection
2025-09-03 10:20:01 - [INFO] -   - 元数据文件: D:\09_Project\EdgeDeepfakeDetection\data\datasets\metadata\video_metadata_c23.csv
2025-09-03 10:20:01 - [INFO] -   - 人脸数据目录: D:\09_Project\EdgeDeepfakeDetection\data\preprocessed\faces_224
2025-09-03 10:20:01 - [INFO] -   - 日志保存目录: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer
2025-09-03 10:20:01 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93
2025-09-03 10:20:01 - [INFO] - 训练参数配置:
2025-09-03 10:20:01 - [INFO] -   - 随机种子: 42
2025-09-03 10:20:01 - [INFO] -   - 批次大小: 32
2025-09-03 10:20:01 - [INFO] -   - 工作进程数: 4
2025-09-03 10:20:01 - [INFO] -   - 训练轮数: 75
2025-09-03 10:20:01 - [INFO] -   - 早停patience: 12
2025-09-03 10:20:01 - [INFO] -   - 学习率: 0.0001
2025-09-03 10:20:01 - [INFO] -   - 权重衰减: 0.05
2025-09-03 10:20:01 - [INFO] - 所有路径检查通过 ✓
2025-09-03 10:20:01 - [INFO] - 正在加载数据集...
2025-09-03 10:20:03 - [INFO] - 数据集加载成功:
2025-09-03 10:20:03 - [INFO] -   - 训练集样本数: 70000
2025-09-03 10:20:03 - [INFO] -   - 验证集样本数: 15000
2025-09-03 10:20:03 - [INFO] -   - 测试集样本数: 15000
2025-09-03 10:20:03 - [INFO] - 标签分布统计:
2025-09-03 10:20:03 - [INFO] -   - 训练集 Real: 35000, Fake: 35000
2025-09-03 10:20:03 - [INFO] -   - 验证集 Real: 7500, Fake: 7500
2025-09-03 10:20:03 - [INFO] -   - 测试集 Real: 7500, Fake: 7500
2025-09-03 10:20:03 - [INFO] - 数据加载器配置: batch_size=32, num_workers=4
2025-09-03 10:20:03 - [INFO] - 正在验证数据加载...
2025-09-03 10:20:23 - [INFO] - 样本批次形状: inputs=torch.Size([32, 3, 224, 224]), labels=torch.Size([32])
2025-09-03 10:20:23 - [INFO] - 输入数据统计: mean=0.0637, std=0.9585
2025-09-03 10:20:23 - [INFO] - 输入数据范围: min=-2.1179, max=2.6400
2025-09-03 10:20:23 - [INFO] - 标签分布: tensor([16, 16])
2025-09-03 10:20:23 - [INFO] - ✓ 数据验证完成
2025-09-03 10:20:23 - [INFO] - 正在初始化Swin Transformer Tiny模型...
2025-09-03 10:20:25 - [INFO] - 已加载预训练的Swin Transformer Tiny模型
2025-09-03 10:20:25 - [INFO] - 模型结构: swin_tiny_patch4_window7_224 + Dropout(0.1)
2025-09-03 10:20:25 - [INFO] - 验证预训练权重加载状态...
2025-09-03 10:20:25 - [INFO] - 第一层权重统计: mean=0.000524, std=0.053220
2025-09-03 10:20:25 - [INFO] - ✓ 权重已正确初始化
2025-09-03 10:20:25 - [INFO] - 使用设备: cuda
2025-09-03 10:20:25 - [INFO] - CUDA设备信息: NVIDIA GeForce RTX 3070 Ti Laptop GPU
2025-09-03 10:20:25 - [INFO] - GPU内存: 8.0 GB
2025-09-03 10:20:25 - [INFO] - 优化器配置:
2025-09-03 10:20:25 - [INFO] -   - 优化器: AdamW
2025-09-03 10:20:25 - [INFO] -   - 初始学习率: 0.0001
2025-09-03 10:20:25 - [INFO] -   - 最小学习率: 1e-5 (提高以保持后期优化能力)
2025-09-03 10:20:25 - [INFO] -   - 权重衰减: 0.05
2025-09-03 10:20:25 - [INFO] -   - 调度器: Warmup(2) + CosineAnnealingLR(T_max=75)
2025-09-03 10:20:25 - [INFO] -   - 损失函数: CrossEntropyLoss (移除label_smoothing追求更低Loss)
2025-09-03 10:20:25 - [INFO] -   - 分类头Dropout: 0.1 (降低以增强拟合能力)
2025-09-03 10:20:25 - [INFO] - ============================================================
2025-09-03 10:20:25 - [INFO] - 开始训练模型
2025-09-03 10:20:25 - [INFO] - ============================================================
2025-09-03 10:20:25 - [INFO] - 模型总参数数量: 27,520,892
2025-09-03 10:20:25 - [INFO] - 可训练参数数量: 27,520,892
2025-09-03 10:20:25 - [INFO] - 训练配置:
2025-09-03 10:20:25 - [INFO] -   - 总epochs: 75
2025-09-03 10:20:25 - [INFO] -   - 早停patience: 12
2025-09-03 10:20:25 - [INFO] -   - 学习率: 1e-05
2025-09-03 10:20:25 - [INFO] -   - 权重衰减: 0.05
2025-09-03 10:20:25 - [INFO] -   - 批次大小: 32
2025-09-03 10:20:25 - [INFO] -   - 训练样本数: 70000
2025-09-03 10:20:25 - [INFO] -   - 验证样本数: 15000
2025-09-03 10:20:25 - [INFO] -   - 设备: cuda:0
2025-09-03 10:20:25 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93
2025-09-03 10:20:25 - [INFO] -   - PyTorch随机种子: 42
2025-09-03 10:20:25 - [INFO] -   - CUDA随机种子: 42
2025-09-03 10:20:25 - [INFO] -   - CUDNN确定性: True
2025-09-03 10:20:25 - [INFO] -   - CUDNN基准测试: False
2025-09-03 10:20:25 - [INFO] - Swin Transformer 使用端到端训练，无需冻结层
2025-09-03 10:20:25 - [INFO] - 
--- Epoch 1/75 ---
2025-09-03 10:20:25 - [INFO] - 当前学习率: 0.000010
2025-09-03 10:31:16 - [INFO] - Epoch 1 结果:
2025-09-03 10:31:16 - [INFO] -   训练 - Loss: 0.400283, AUC: 0.8971, Acc: 0.8071
2025-09-03 10:31:16 - [INFO] -   验证 - Loss: 0.387650, AUC: 0.9447, Acc: 0.8505
2025-09-03 10:31:16 - [INFO] -   时间 - 训练: 581.5s, 验证: 69.2s, 总计: 650.7s
2025-09-03 10:31:16 - [INFO] -   学习率: 0.000010
2025-09-03 10:31:16 - [INFO] -   *** 新的最佳验证AUC: 0.9447 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_best.pth ***
2025-09-03 10:31:16 - [INFO] - 
--- Epoch 2/75 ---
2025-09-03 10:31:16 - [INFO] - 当前学习率: 0.000055
2025-09-03 10:42:03 - [INFO] - Epoch 2 结果:
2025-09-03 10:42:03 - [INFO] -   训练 - Loss: 0.268125, AUC: 0.9558, Acc: 0.8873
2025-09-03 10:42:03 - [INFO] -   验证 - Loss: 0.354022, AUC: 0.9594, Acc: 0.8803
2025-09-03 10:42:03 - [INFO] -   时间 - 训练: 581.9s, 验证: 65.1s, 总计: 647.1s
2025-09-03 10:42:03 - [INFO] -   学习率: 0.000055
2025-09-03 10:42:03 - [INFO] -   *** 新的最佳验证AUC: 0.9594 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_best.pth ***
2025-09-03 10:42:03 - [INFO] - 
--- Epoch 3/75 ---
2025-09-03 10:42:03 - [INFO] - 当前学习率: 0.000100
2025-09-03 10:52:52 - [INFO] - Epoch 3 结果:
2025-09-03 10:52:52 - [INFO] -   训练 - Loss: 0.222704, AUC: 0.9695, Acc: 0.9105
2025-09-03 10:52:52 - [INFO] -   验证 - Loss: 0.256293, AUC: 0.9669, Acc: 0.8987
2025-09-03 10:52:52 - [INFO] -   时间 - 训练: 583.6s, 验证: 65.7s, 总计: 649.4s
2025-09-03 10:52:52 - [INFO] -   学习率: 0.000100
2025-09-03 10:52:52 - [INFO] -   *** 新的最佳验证AUC: 0.9669 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_best.pth ***
2025-09-03 10:52:52 - [INFO] - 
--- Epoch 4/75 ---
2025-09-03 10:52:52 - [INFO] - 当前学习率: 0.000100
2025-09-03 11:03:39 - [INFO] - Epoch 4 结果:
2025-09-03 11:03:39 - [INFO] -   训练 - Loss: 0.175080, AUC: 0.9809, Acc: 0.9321
2025-09-03 11:03:39 - [INFO] -   验证 - Loss: 0.391748, AUC: 0.9732, Acc: 0.8911
2025-09-03 11:03:39 - [INFO] -   时间 - 训练: 581.2s, 验证: 65.4s, 总计: 646.7s
2025-09-03 11:03:39 - [INFO] -   学习率: 0.000100
2025-09-03 11:03:39 - [INFO] -   *** 新的最佳验证AUC: 0.9732 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_best.pth ***
2025-09-03 11:03:39 - [INFO] - 
--- Epoch 5/75 ---
2025-09-03 11:03:39 - [INFO] - 当前学习率: 0.000100
2025-09-03 11:14:26 - [INFO] - Epoch 5 结果:
2025-09-03 11:14:26 - [INFO] -   训练 - Loss: 0.151633, AUC: 0.9858, Acc: 0.9433
2025-09-03 11:14:26 - [INFO] -   验证 - Loss: 0.371600, AUC: 0.9650, Acc: 0.9007
2025-09-03 11:14:26 - [INFO] -   时间 - 训练: 580.2s, 验证: 66.0s, 总计: 646.2s
2025-09-03 11:14:26 - [INFO] -   学习率: 0.000100
2025-09-03 11:14:26 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-03 11:14:26 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_epoch_5.pth
2025-09-03 11:14:26 - [INFO] - 
--- Epoch 6/75 ---
2025-09-03 11:14:26 - [INFO] - 当前学习率: 0.000100
2025-09-03 11:25:10 - [INFO] - Epoch 6 结果:
2025-09-03 11:25:10 - [INFO] -   训练 - Loss: 0.132715, AUC: 0.9891, Acc: 0.9508
2025-09-03 11:25:10 - [INFO] -   验证 - Loss: 0.207620, AUC: 0.9791, Acc: 0.9291
2025-09-03 11:25:10 - [INFO] -   时间 - 训练: 579.3s, 验证: 65.4s, 总计: 644.8s
2025-09-03 11:25:10 - [INFO] -   学习率: 0.000100
2025-09-03 11:25:11 - [INFO] -   *** 新的最佳验证AUC: 0.9791 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_best.pth ***
2025-09-03 11:25:11 - [INFO] - 
--- Epoch 7/75 ---
2025-09-03 11:25:11 - [INFO] - 当前学习率: 0.000099
2025-09-03 11:35:57 - [INFO] - Epoch 7 结果:
2025-09-03 11:35:57 - [INFO] -   训练 - Loss: 0.120672, AUC: 0.9910, Acc: 0.9563
2025-09-03 11:35:57 - [INFO] -   验证 - Loss: 0.261003, AUC: 0.9750, Acc: 0.9199
2025-09-03 11:35:57 - [INFO] -   时间 - 训练: 581.0s, 验证: 65.4s, 总计: 646.5s
2025-09-03 11:35:57 - [INFO] -   学习率: 0.000099
2025-09-03 11:35:57 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-03 11:35:57 - [INFO] - 
--- Epoch 8/75 ---
2025-09-03 11:35:57 - [INFO] - 当前学习率: 0.000099
2025-09-03 11:47:01 - [INFO] - Epoch 8 结果:
2025-09-03 11:47:01 - [INFO] -   训练 - Loss: 0.115647, AUC: 0.9919, Acc: 0.9582
2025-09-03 11:47:01 - [INFO] -   验证 - Loss: 0.245223, AUC: 0.9775, Acc: 0.9195
2025-09-03 11:47:01 - [INFO] -   时间 - 训练: 596.0s, 验证: 67.4s, 总计: 663.5s
2025-09-03 11:47:01 - [INFO] -   学习率: 0.000099
2025-09-03 11:47:01 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-09-03 11:47:01 - [INFO] - 
--- Epoch 9/75 ---
2025-09-03 11:47:01 - [INFO] - 当前学习率: 0.000099
2025-09-03 11:58:15 - [INFO] - Epoch 9 结果:
2025-09-03 11:58:15 - [INFO] -   训练 - Loss: 0.107287, AUC: 0.9930, Acc: 0.9616
2025-09-03 11:58:15 - [INFO] -   验证 - Loss: 0.423598, AUC: 0.9773, Acc: 0.8893
2025-09-03 11:58:15 - [INFO] -   时间 - 训练: 606.4s, 验证: 68.3s, 总计: 674.8s
2025-09-03 11:58:15 - [INFO] -   学习率: 0.000099
2025-09-03 11:58:15 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-09-03 11:58:15 - [INFO] - 
--- Epoch 10/75 ---
2025-09-03 11:58:15 - [INFO] - 当前学习率: 0.000098
2025-09-03 12:09:31 - [INFO] - Epoch 10 结果:
2025-09-03 12:09:31 - [INFO] -   训练 - Loss: 0.104798, AUC: 0.9934, Acc: 0.9636
2025-09-03 12:09:31 - [INFO] -   验证 - Loss: 0.347708, AUC: 0.9756, Acc: 0.9173
2025-09-03 12:09:31 - [INFO] -   时间 - 训练: 606.6s, 验证: 68.4s, 总计: 675.1s
2025-09-03 12:09:31 - [INFO] -   学习率: 0.000098
2025-09-03 12:09:31 - [INFO] -   验证AUC未改善，连续4轮未提升
2025-09-03 12:09:31 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_epoch_10.pth
2025-09-03 12:09:31 - [INFO] - 
--- Epoch 11/75 ---
2025-09-03 12:09:31 - [INFO] - 当前学习率: 0.000097
2025-09-03 12:20:18 - [INFO] - Epoch 11 结果:
2025-09-03 12:20:18 - [INFO] -   训练 - Loss: 0.097230, AUC: 0.9943, Acc: 0.9660
2025-09-03 12:20:18 - [INFO] -   验证 - Loss: 0.307549, AUC: 0.9688, Acc: 0.9079
2025-09-03 12:20:18 - [INFO] -   时间 - 训练: 581.6s, 验证: 65.5s, 总计: 647.2s
2025-09-03 12:20:18 - [INFO] -   学习率: 0.000097
2025-09-03 12:20:18 - [INFO] -   验证AUC未改善，连续5轮未提升
2025-09-03 12:20:18 - [INFO] - 
--- Epoch 12/75 ---
2025-09-03 12:20:18 - [INFO] - 当前学习率: 0.000097
2025-09-03 12:31:02 - [INFO] - Epoch 12 结果:
2025-09-03 12:31:02 - [INFO] -   训练 - Loss: 0.093528, AUC: 0.9948, Acc: 0.9679
2025-09-03 12:31:02 - [INFO] -   验证 - Loss: 0.286231, AUC: 0.9730, Acc: 0.9120
2025-09-03 12:31:02 - [INFO] -   时间 - 训练: 578.4s, 验证: 65.7s, 总计: 644.2s
2025-09-03 12:31:02 - [INFO] -   学习率: 0.000097
2025-09-03 12:31:02 - [INFO] -   验证AUC未改善，连续6轮未提升
2025-09-03 12:31:02 - [INFO] - 
--- Epoch 13/75 ---
2025-09-03 12:31:02 - [INFO] - 当前学习率: 0.000096
2025-09-03 12:41:46 - [INFO] - Epoch 13 结果:
2025-09-03 12:41:46 - [INFO] -   训练 - Loss: 0.091181, AUC: 0.9950, Acc: 0.9689
2025-09-03 12:41:46 - [INFO] -   验证 - Loss: 0.367795, AUC: 0.9702, Acc: 0.9100
2025-09-03 12:41:46 - [INFO] -   时间 - 训练: 578.6s, 验证: 65.3s, 总计: 644.0s
2025-09-03 12:41:46 - [INFO] -   学习率: 0.000096
2025-09-03 12:41:46 - [INFO] -   验证AUC未改善，连续7轮未提升
2025-09-03 12:41:46 - [INFO] - 
--- Epoch 14/75 ---
2025-09-03 12:41:46 - [INFO] - 当前学习率: 0.000095
2025-09-03 12:52:30 - [INFO] - Epoch 14 结果:
2025-09-03 12:52:30 - [INFO] -   训练 - Loss: 0.087257, AUC: 0.9956, Acc: 0.9698
2025-09-03 12:52:30 - [INFO] -   验证 - Loss: 0.280701, AUC: 0.9780, Acc: 0.9256
2025-09-03 12:52:30 - [INFO] -   时间 - 训练: 578.7s, 验证: 65.3s, 总计: 644.1s
2025-09-03 12:52:30 - [INFO] -   学习率: 0.000095
2025-09-03 12:52:30 - [INFO] -   验证AUC未改善，连续8轮未提升
2025-09-03 12:52:30 - [INFO] - 
--- Epoch 15/75 ---
2025-09-03 12:52:30 - [INFO] - 当前学习率: 0.000094
2025-09-03 13:03:15 - [INFO] - Epoch 15 结果:
2025-09-03 13:03:15 - [INFO] -   训练 - Loss: 0.084535, AUC: 0.9958, Acc: 0.9716
2025-09-03 13:03:15 - [INFO] -   验证 - Loss: 0.265006, AUC: 0.9771, Acc: 0.9279
2025-09-03 13:03:15 - [INFO] -   时间 - 训练: 579.3s, 验证: 65.3s, 总计: 644.7s
2025-09-03 13:03:15 - [INFO] -   学习率: 0.000094
2025-09-03 13:03:15 - [INFO] -   验证AUC未改善，连续9轮未提升
2025-09-03 13:03:15 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_epoch_15.pth
2025-09-03 13:03:15 - [INFO] - 
--- Epoch 16/75 ---
2025-09-03 13:03:15 - [INFO] - 当前学习率: 0.000093
2025-09-03 13:14:00 - [INFO] - Epoch 16 结果:
2025-09-03 13:14:00 - [INFO] -   训练 - Loss: 0.082244, AUC: 0.9960, Acc: 0.9717
2025-09-03 13:14:00 - [INFO] -   验证 - Loss: 0.261082, AUC: 0.9765, Acc: 0.9247
2025-09-03 13:14:00 - [INFO] -   时间 - 训练: 579.1s, 验证: 65.4s, 总计: 644.6s
2025-09-03 13:14:00 - [INFO] -   学习率: 0.000093
2025-09-03 13:14:00 - [INFO] -   验证AUC未改善，连续10轮未提升
2025-09-03 13:14:00 - [INFO] - 
--- Epoch 17/75 ---
2025-09-03 13:14:00 - [INFO] - 当前学习率: 0.000092
2025-09-03 13:24:44 - [INFO] - Epoch 17 结果:
2025-09-03 13:24:44 - [INFO] -   训练 - Loss: 0.078074, AUC: 0.9964, Acc: 0.9733
2025-09-03 13:24:44 - [INFO] -   验证 - Loss: 0.328408, AUC: 0.9774, Acc: 0.9239
2025-09-03 13:24:44 - [INFO] -   时间 - 训练: 579.3s, 验证: 65.1s, 总计: 644.5s
2025-09-03 13:24:44 - [INFO] -   学习率: 0.000092
2025-09-03 13:24:44 - [INFO] -   验证AUC未改善，连续11轮未提升
2025-09-03 13:24:44 - [INFO] - 
--- Epoch 18/75 ---
2025-09-03 13:24:44 - [INFO] - 当前学习率: 0.000091
2025-09-03 13:35:28 - [INFO] - Epoch 18 结果:
2025-09-03 13:35:28 - [INFO] -   训练 - Loss: 0.076259, AUC: 0.9964, Acc: 0.9750
2025-09-03 13:35:28 - [INFO] -   验证 - Loss: 0.263961, AUC: 0.9826, Acc: 0.9298
2025-09-03 13:35:28 - [INFO] -   时间 - 训练: 579.0s, 验证: 65.3s, 总计: 644.4s
2025-09-03 13:35:28 - [INFO] -   学习率: 0.000091
2025-09-03 13:35:29 - [INFO] -   *** 新的最佳验证AUC: 0.9826 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_best.pth ***
2025-09-03 13:35:29 - [INFO] - 
--- Epoch 19/75 ---
2025-09-03 13:35:29 - [INFO] - 当前学习率: 0.000090
2025-09-03 13:46:14 - [INFO] - Epoch 19 结果:
2025-09-03 13:46:14 - [INFO] -   训练 - Loss: 0.074450, AUC: 0.9969, Acc: 0.9751
2025-09-03 13:46:14 - [INFO] -   验证 - Loss: 0.248811, AUC: 0.9787, Acc: 0.9288
2025-09-03 13:46:14 - [INFO] -   时间 - 训练: 580.7s, 验证: 65.0s, 总计: 645.8s
2025-09-03 13:46:14 - [INFO] -   学习率: 0.000090
2025-09-03 13:46:14 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-03 13:46:14 - [INFO] - 
--- Epoch 20/75 ---
2025-09-03 13:46:14 - [INFO] - 当前学习率: 0.000089
2025-09-03 13:56:57 - [INFO] - Epoch 20 结果:
2025-09-03 13:56:57 - [INFO] -   训练 - Loss: 0.070047, AUC: 0.9972, Acc: 0.9764
2025-09-03 13:56:57 - [INFO] -   验证 - Loss: 0.316201, AUC: 0.9789, Acc: 0.9281
2025-09-03 13:56:57 - [INFO] -   时间 - 训练: 577.9s, 验证: 65.1s, 总计: 643.0s
2025-09-03 13:56:57 - [INFO] -   学习率: 0.000089
2025-09-03 13:56:57 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-09-03 13:56:58 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_epoch_20.pth
2025-09-03 13:56:58 - [INFO] - 
--- Epoch 21/75 ---
2025-09-03 13:56:58 - [INFO] - 当前学习率: 0.000088
2025-09-03 14:07:42 - [INFO] - Epoch 21 结果:
2025-09-03 14:07:42 - [INFO] -   训练 - Loss: 0.069898, AUC: 0.9972, Acc: 0.9772
2025-09-03 14:07:42 - [INFO] -   验证 - Loss: 0.422000, AUC: 0.9755, Acc: 0.8977
2025-09-03 14:07:42 - [INFO] -   时间 - 训练: 579.4s, 验证: 65.3s, 总计: 644.8s
2025-09-03 14:07:42 - [INFO] -   学习率: 0.000088
2025-09-03 14:07:42 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-09-03 14:07:42 - [INFO] - 
--- Epoch 22/75 ---
2025-09-03 14:07:42 - [INFO] - 当前学习率: 0.000086
2025-09-03 14:18:25 - [INFO] - Epoch 22 结果:
2025-09-03 14:18:25 - [INFO] -   训练 - Loss: 0.070423, AUC: 0.9971, Acc: 0.9774
2025-09-03 14:18:25 - [INFO] -   验证 - Loss: 0.254889, AUC: 0.9819, Acc: 0.9325
2025-09-03 14:18:25 - [INFO] -   时间 - 训练: 577.4s, 验证: 65.2s, 总计: 642.7s
2025-09-03 14:18:25 - [INFO] -   学习率: 0.000086
2025-09-03 14:18:25 - [INFO] -   验证AUC未改善，连续4轮未提升
2025-09-03 14:18:25 - [INFO] - 
--- Epoch 23/75 ---
2025-09-03 14:18:25 - [INFO] - 当前学习率: 0.000085
2025-09-03 14:29:10 - [INFO] - Epoch 23 结果:
2025-09-03 14:29:10 - [INFO] -   训练 - Loss: 0.066358, AUC: 0.9974, Acc: 0.9787
2025-09-03 14:29:10 - [INFO] -   验证 - Loss: 0.394956, AUC: 0.9694, Acc: 0.9087
2025-09-03 14:29:10 - [INFO] -   时间 - 训练: 579.4s, 验证: 65.2s, 总计: 644.7s
2025-09-03 14:29:10 - [INFO] -   学习率: 0.000085
2025-09-03 14:29:10 - [INFO] -   验证AUC未改善，连续5轮未提升
2025-09-03 14:29:10 - [INFO] - 
--- Epoch 24/75 ---
2025-09-03 14:29:10 - [INFO] - 当前学习率: 0.000084
2025-09-03 14:40:04 - [INFO] - Epoch 24 结果:
2025-09-03 14:40:04 - [INFO] -   训练 - Loss: 0.064090, AUC: 0.9978, Acc: 0.9790
2025-09-03 14:40:04 - [INFO] -   验证 - Loss: 0.403238, AUC: 0.9769, Acc: 0.9276
2025-09-03 14:40:04 - [INFO] -   时间 - 训练: 586.4s, 验证: 67.7s, 总计: 654.2s
2025-09-03 14:40:04 - [INFO] -   学习率: 0.000084
2025-09-03 14:40:04 - [INFO] -   验证AUC未改善，连续6轮未提升
2025-09-03 14:40:04 - [INFO] - 
--- Epoch 25/75 ---
2025-09-03 14:40:04 - [INFO] - 当前学习率: 0.000082
2025-09-03 14:51:20 - [INFO] - Epoch 25 结果:
2025-09-03 14:51:20 - [INFO] -   训练 - Loss: 0.061665, AUC: 0.9979, Acc: 0.9801
2025-09-03 14:51:20 - [INFO] -   验证 - Loss: 0.320603, AUC: 0.9776, Acc: 0.9275
2025-09-03 14:51:20 - [INFO] -   时间 - 训练: 607.5s, 验证: 68.2s, 总计: 675.7s
2025-09-03 14:51:20 - [INFO] -   学习率: 0.000082
2025-09-03 14:51:20 - [INFO] -   验证AUC未改善，连续7轮未提升
2025-09-03 14:51:20 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_epoch_25.pth
2025-09-03 14:51:20 - [INFO] - 
--- Epoch 26/75 ---
2025-09-03 14:51:20 - [INFO] - 当前学习率: 0.000081
2025-09-03 15:02:36 - [INFO] - Epoch 26 结果:
2025-09-03 15:02:36 - [INFO] -   训练 - Loss: 0.060521, AUC: 0.9980, Acc: 0.9805
2025-09-03 15:02:36 - [INFO] -   验证 - Loss: 0.369401, AUC: 0.9755, Acc: 0.9213
2025-09-03 15:02:36 - [INFO] -   时间 - 训练: 607.9s, 验证: 68.4s, 总计: 676.4s
2025-09-03 15:02:36 - [INFO] -   学习率: 0.000081
2025-09-03 15:02:36 - [INFO] -   验证AUC未改善，连续8轮未提升
2025-09-03 15:02:36 - [INFO] - 
--- Epoch 27/75 ---
2025-09-03 15:02:36 - [INFO] - 当前学习率: 0.000079
2025-09-03 15:13:52 - [INFO] - Epoch 27 结果:
2025-09-03 15:13:52 - [INFO] -   训练 - Loss: 0.059342, AUC: 0.9981, Acc: 0.9814
2025-09-03 15:13:52 - [INFO] -   验证 - Loss: 0.357013, AUC: 0.9760, Acc: 0.9187
2025-09-03 15:13:52 - [INFO] -   时间 - 训练: 606.4s, 验证: 68.9s, 总计: 675.3s
2025-09-03 15:13:52 - [INFO] -   学习率: 0.000079
2025-09-03 15:13:52 - [INFO] -   验证AUC未改善，连续9轮未提升
2025-09-03 15:13:52 - [INFO] - 
--- Epoch 28/75 ---
2025-09-03 15:13:52 - [INFO] - 当前学习率: 0.000078
2025-09-03 15:25:06 - [INFO] - Epoch 28 结果:
2025-09-03 15:25:06 - [INFO] -   训练 - Loss: 0.058961, AUC: 0.9980, Acc: 0.9810
2025-09-03 15:25:06 - [INFO] -   验证 - Loss: 0.311460, AUC: 0.9767, Acc: 0.9291
2025-09-03 15:25:06 - [INFO] -   时间 - 训练: 606.0s, 验证: 68.1s, 总计: 674.2s
2025-09-03 15:25:06 - [INFO] -   学习率: 0.000078
2025-09-03 15:25:06 - [INFO] -   验证AUC未改善，连续10轮未提升
2025-09-03 15:25:06 - [INFO] - 
--- Epoch 29/75 ---
2025-09-03 15:25:06 - [INFO] - 当前学习率: 0.000076
2025-09-03 15:36:19 - [INFO] - Epoch 29 结果:
2025-09-03 15:36:19 - [INFO] -   训练 - Loss: 0.055331, AUC: 0.9984, Acc: 0.9820
2025-09-03 15:36:19 - [INFO] -   验证 - Loss: 0.332751, AUC: 0.9778, Acc: 0.9264
2025-09-03 15:36:19 - [INFO] -   时间 - 训练: 606.1s, 验证: 67.4s, 总计: 673.5s
2025-09-03 15:36:19 - [INFO] -   学习率: 0.000076
2025-09-03 15:36:19 - [INFO] -   验证AUC未改善，连续11轮未提升
2025-09-03 15:36:19 - [INFO] - 
--- Epoch 30/75 ---
2025-09-03 15:36:19 - [INFO] - 当前学习率: 0.000074
2025-09-03 15:47:34 - [INFO] - Epoch 30 结果:
2025-09-03 15:47:34 - [INFO] -   训练 - Loss: 0.052111, AUC: 0.9984, Acc: 0.9834
2025-09-03 15:47:34 - [INFO] -   验证 - Loss: 0.351255, AUC: 0.9785, Acc: 0.9260
2025-09-03 15:47:34 - [INFO] -   时间 - 训练: 607.0s, 验证: 68.0s, 总计: 675.1s
2025-09-03 15:47:34 - [INFO] -   学习率: 0.000074
2025-09-03 15:47:34 - [INFO] -   验证AUC未改善，连续12轮未提升
2025-09-03 15:47:34 - [INFO] - 达到早停条件 (patience=12)，在epoch 30停止训练
2025-09-03 15:47:34 - [INFO] - ============================================================
2025-09-03 15:47:34 - [INFO] - 训练完成!
2025-09-03 15:47:34 - [INFO] - 最佳验证AUC: 0.9826
2025-09-03 15:47:34 - [INFO] - 总训练时间: 5.45 小时
2025-09-03 15:47:34 - [INFO] - 最佳模型保存位置: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune_93\swin_tiny_best.pth
2025-09-03 15:47:34 - [INFO] - ============================================================
2025-09-03 15:47:34 - [INFO] - 训练结束 - 最佳验证AUC: 0.9826
2025-09-03 15:47:34 - [INFO] - 
============================================================
2025-09-03 15:47:34 - [INFO] - 开始测试阶段 - 纯净性能（无H.264噪声）
2025-09-03 15:47:34 - [INFO] - ============================================================
2025-09-03 15:48:42 - [INFO] - 纯净测试结果:
2025-09-03 15:48:42 - [INFO] -   - 测试AUC: 0.9843
2025-09-03 15:48:42 - [INFO] -   - 测试准确率: 0.9318
2025-09-03 15:48:42 - [INFO] -   - 测试时间: 67.56秒
2025-09-03 15:48:42 - [INFO] -   - 测试样本数: 15000
2025-09-03 15:48:42 - [INFO] - 
============================================================
2025-09-03 15:48:42 - [INFO] - 开始测试阶段 - 噪声鲁棒性（含H.264噪声）
2025-09-03 15:48:42 - [INFO] - ============================================================
2025-09-03 15:49:50 - [INFO] - 噪声测试结果:
2025-09-03 15:49:50 - [INFO] -   - 测试AUC (噪声): 0.9453
2025-09-03 15:49:50 - [INFO] -   - 测试准确率 (噪声): 0.8721
2025-09-03 15:49:50 - [INFO] -   - 测试时间: 67.87秒
2025-09-03 15:49:50 - [INFO] -   - 鲁棒性评估 (AUC下降): 0.0390
2025-09-03 15:49:50 - [INFO] - 
================================================================================
2025-09-03 15:49:50 - [INFO] - 程序执行完成
2025-09-03 15:49:50 - [INFO] - 结束时间: 2025-09-03 15:49:50
2025-09-03 15:49:50 - [INFO] - 总执行时间: 5.50 小时
2025-09-03 15:49:50 - [INFO] - 
最终结果总结:
2025-09-03 15:49:50 - [INFO] -   - 最佳验证AUC: 0.9826
2025-09-03 15:49:50 - [INFO] -   - 纯净测试AUC: 0.9843
2025-09-03 15:49:50 - [INFO] -   - 噪声测试AUC: 0.9453
2025-09-03 15:49:50 - [INFO] -   - 噪声鲁棒性: 96.0%
2025-09-03 15:49:50 - [INFO] - ================================================================================

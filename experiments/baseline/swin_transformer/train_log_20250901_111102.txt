2025-09-01 11:11:02 - [INFO] - 日志文件保存位置: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer\train_log_20250901_111102.txt
2025-09-01 11:11:02 - [INFO] - ================================================================================
2025-09-01 11:11:02 - [INFO] - Swin Transformer Tiny Deepfake Detection Training
2025-09-01 11:11:02 - [INFO] - 开始时间: 2025-09-01 11:11:02
2025-09-01 11:11:02 - [INFO] - ================================================================================
2025-09-01 11:11:02 - [INFO] - 路径配置:
2025-09-01 11:11:02 - [INFO] -   - 基础目录: D:\09_Project\EdgeDeepfakeDetection
2025-09-01 11:11:02 - [INFO] -   - 元数据文件: D:\09_Project\EdgeDeepfakeDetection\data\datasets\metadata\video_metadata_c23.csv
2025-09-01 11:11:02 - [INFO] -   - 人脸数据目录: D:\09_Project\EdgeDeepfakeDetection\data\preprocessed\faces_224
2025-09-01 11:11:02 - [INFO] -   - 日志保存目录: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer
2025-09-01 11:11:02 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune
2025-09-01 11:11:02 - [INFO] - 训练参数配置:
2025-09-01 11:11:02 - [INFO] -   - 随机种子: 42
2025-09-01 11:11:02 - [INFO] -   - 批次大小: 32
2025-09-01 11:11:02 - [INFO] -   - 工作进程数: 4
2025-09-01 11:11:02 - [INFO] -   - 训练轮数: 60
2025-09-01 11:11:02 - [INFO] -   - 早停patience: 10
2025-09-01 11:11:02 - [INFO] -   - 学习率: 0.0002
2025-09-01 11:11:02 - [INFO] -   - 权重衰减: 0.01
2025-09-01 11:11:02 - [INFO] - 所有路径检查通过 ✓
2025-09-01 11:11:02 - [INFO] - 正在加载数据集...
2025-09-01 11:11:04 - [INFO] - 数据集加载成功:
2025-09-01 11:11:04 - [INFO] -   - 训练集样本数: 70000
2025-09-01 11:11:04 - [INFO] -   - 验证集样本数: 15000
2025-09-01 11:11:04 - [INFO] -   - 测试集样本数: 15000
2025-09-01 11:11:04 - [INFO] - 标签分布统计:
2025-09-01 11:11:04 - [INFO] -   - 训练集 Real: 35000, Fake: 35000
2025-09-01 11:11:04 - [INFO] -   - 验证集 Real: 7500, Fake: 7500
2025-09-01 11:11:04 - [INFO] -   - 测试集 Real: 7500, Fake: 7500
2025-09-01 11:11:04 - [INFO] - 数据加载器配置: batch_size=32, num_workers=4
2025-09-01 11:11:04 - [INFO] - 正在验证数据加载...
2025-09-01 11:11:24 - [INFO] - 样本批次形状: inputs=torch.Size([32, 3, 224, 224]), labels=torch.Size([32])
2025-09-01 11:11:24 - [INFO] - 输入数据统计: mean=0.0637, std=0.9585
2025-09-01 11:11:24 - [INFO] - 输入数据范围: min=-2.1179, max=2.6400
2025-09-01 11:11:24 - [INFO] - 标签分布: tensor([16, 16])
2025-09-01 11:11:24 - [INFO] - ✓ 数据验证完成
2025-09-01 11:11:24 - [INFO] - 正在初始化Swin Transformer Tiny模型...
2025-09-01 11:11:26 - [INFO] - 已加载预训练的Swin Transformer Tiny模型
2025-09-01 11:11:26 - [INFO] - 模型结构: swin_tiny_patch4_window7_224 + Dropout(0.3)
2025-09-01 11:11:26 - [INFO] - 验证预训练权重加载状态...
2025-09-01 11:11:26 - [INFO] - 第一层权重统计: mean=0.000524, std=0.053220
2025-09-01 11:11:26 - [INFO] - ✓ 权重已正确初始化
2025-09-01 11:11:26 - [INFO] - 使用设备: cuda
2025-09-01 11:11:26 - [INFO] - CUDA设备信息: NVIDIA GeForce RTX 3070 Ti Laptop GPU
2025-09-01 11:11:26 - [INFO] - GPU内存: 8.0 GB
2025-09-01 11:11:26 - [INFO] - 优化器配置:
2025-09-01 11:11:26 - [INFO] -   - 优化器: AdamW
2025-09-01 11:11:26 - [INFO] -   - 初始学习率: 0.0002
2025-09-01 11:11:26 - [INFO] -   - 最小学习率: 1e-6
2025-09-01 11:11:26 - [INFO] -   - 权重衰减: 0.01
2025-09-01 11:11:26 - [INFO] -   - 调度器: Warmup(10) + CosineAnnealingLR(T_max=60)
2025-09-01 11:11:26 - [INFO] -   - 损失函数: CrossEntropyLoss (label_smoothing=0.1)
2025-09-01 11:11:26 - [INFO] -   - 分类头Dropout: 0.3
2025-09-01 11:11:26 - [INFO] - ============================================================
2025-09-01 11:11:26 - [INFO] - 开始训练模型
2025-09-01 11:11:26 - [INFO] - ============================================================
2025-09-01 11:11:26 - [INFO] - 模型总参数数量: 27,520,892
2025-09-01 11:11:26 - [INFO] - 可训练参数数量: 27,520,892
2025-09-01 11:11:26 - [INFO] - 训练配置:
2025-09-01 11:11:26 - [INFO] -   - 总epochs: 60
2025-09-01 11:11:26 - [INFO] -   - 早停patience: 10
2025-09-01 11:11:26 - [INFO] -   - 学习率: 2e-05
2025-09-01 11:11:26 - [INFO] -   - 权重衰减: 0.01
2025-09-01 11:11:26 - [INFO] -   - 批次大小: 32
2025-09-01 11:11:26 - [INFO] -   - 训练样本数: 70000
2025-09-01 11:11:26 - [INFO] -   - 验证样本数: 15000
2025-09-01 11:11:26 - [INFO] -   - 设备: cuda:0
2025-09-01 11:11:26 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune
2025-09-01 11:11:26 - [INFO] -   - PyTorch随机种子: 42
2025-09-01 11:11:27 - [INFO] -   - CUDA随机种子: 42
2025-09-01 11:11:27 - [INFO] -   - CUDNN确定性: True
2025-09-01 11:11:27 - [INFO] -   - CUDNN基准测试: False
2025-09-01 11:11:27 - [INFO] - Swin Transformer 使用端到端训练，无需冻结层
2025-09-01 11:11:27 - [INFO] - 
--- Epoch 1/60 ---
2025-09-01 11:11:27 - [INFO] - 当前学习率: 0.000020
2025-09-01 11:22:12 - [INFO] - Epoch 1 结果:
2025-09-01 11:22:12 - [INFO] -   训练 - Loss: 0.435756, AUC: 0.9223, Acc: 0.8380
2025-09-01 11:22:12 - [INFO] -   验证 - Loss: 0.395271, AUC: 0.9545, Acc: 0.8867
2025-09-01 11:22:12 - [INFO] -   时间 - 训练: 579.7s, 验证: 66.2s, 总计: 646.0s
2025-09-01 11:22:12 - [INFO] -   学习率: 0.000020
2025-09-01 11:22:13 - [INFO] -   *** 新的最佳验证AUC: 0.9545 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 11:22:13 - [INFO] - 
--- Epoch 2/60 ---
2025-09-01 11:22:13 - [INFO] - 当前学习率: 0.000038
2025-09-01 11:32:57 - [INFO] - Epoch 2 结果:
2025-09-01 11:32:57 - [INFO] -   训练 - Loss: 0.342401, AUC: 0.9688, Acc: 0.9106
2025-09-01 11:32:57 - [INFO] -   验证 - Loss: 0.373402, AUC: 0.9615, Acc: 0.8996
2025-09-01 11:32:57 - [INFO] -   时间 - 训练: 578.8s, 验证: 65.2s, 总计: 644.0s
2025-09-01 11:32:57 - [INFO] -   学习率: 0.000038
2025-09-01 11:32:57 - [INFO] -   *** 新的最佳验证AUC: 0.9615 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 11:32:57 - [INFO] - 
--- Epoch 3/60 ---
2025-09-01 11:32:57 - [INFO] - 当前学习率: 0.000056
2025-09-01 11:43:42 - [INFO] - Epoch 3 结果:
2025-09-01 11:43:42 - [INFO] -   训练 - Loss: 0.319889, AUC: 0.9763, Acc: 0.9278
2025-09-01 11:43:42 - [INFO] -   验证 - Loss: 0.375094, AUC: 0.9654, Acc: 0.8985
2025-09-01 11:43:42 - [INFO] -   时间 - 训练: 580.5s, 验证: 65.1s, 总计: 645.7s
2025-09-01 11:43:42 - [INFO] -   学习率: 0.000056
2025-09-01 11:43:43 - [INFO] -   *** 新的最佳验证AUC: 0.9654 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 11:43:43 - [INFO] - 
--- Epoch 4/60 ---
2025-09-01 11:43:43 - [INFO] - 当前学习率: 0.000074
2025-09-01 11:54:36 - [INFO] - Epoch 4 结果:
2025-09-01 11:54:36 - [INFO] -   训练 - Loss: 0.310002, AUC: 0.9801, Acc: 0.9324
2025-09-01 11:54:36 - [INFO] -   验证 - Loss: 0.386330, AUC: 0.9664, Acc: 0.9030
2025-09-01 11:54:36 - [INFO] -   时间 - 训练: 587.7s, 验证: 65.4s, 总计: 653.1s
2025-09-01 11:54:36 - [INFO] -   学习率: 0.000074
2025-09-01 11:54:36 - [INFO] -   *** 新的最佳验证AUC: 0.9664 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 11:54:36 - [INFO] - 
--- Epoch 5/60 ---
2025-09-01 11:54:36 - [INFO] - 当前学习率: 0.000092
2025-09-01 12:05:22 - [INFO] - Epoch 5 结果:
2025-09-01 12:05:22 - [INFO] -   训练 - Loss: 0.303419, AUC: 0.9817, Acc: 0.9378
2025-09-01 12:05:22 - [INFO] -   验证 - Loss: 0.418199, AUC: 0.9688, Acc: 0.8837
2025-09-01 12:05:22 - [INFO] -   时间 - 训练: 580.2s, 验证: 65.7s, 总计: 645.9s
2025-09-01 12:05:22 - [INFO] -   学习率: 0.000092
2025-09-01 12:05:22 - [INFO] -   *** 新的最佳验证AUC: 0.9688 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 12:05:22 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_epoch_5.pth
2025-09-01 12:05:22 - [INFO] - 
--- Epoch 6/60 ---
2025-09-01 12:05:22 - [INFO] - 当前学习率: 0.000110
2025-09-01 12:16:08 - [INFO] - Epoch 6 结果:
2025-09-01 12:16:08 - [INFO] -   训练 - Loss: 0.303974, AUC: 0.9816, Acc: 0.9373
2025-09-01 12:16:08 - [INFO] -   验证 - Loss: 0.359917, AUC: 0.9714, Acc: 0.9119
2025-09-01 12:16:08 - [INFO] -   时间 - 训练: 580.4s, 验证: 65.3s, 总计: 645.7s
2025-09-01 12:16:08 - [INFO] -   学习率: 0.000110
2025-09-01 12:16:08 - [INFO] -   *** 新的最佳验证AUC: 0.9714 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 12:16:08 - [INFO] - 
--- Epoch 7/60 ---
2025-09-01 12:16:08 - [INFO] - 当前学习率: 0.000128
2025-09-01 12:26:54 - [INFO] - Epoch 7 结果:
2025-09-01 12:26:54 - [INFO] -   训练 - Loss: 0.301066, AUC: 0.9830, Acc: 0.9388
2025-09-01 12:26:54 - [INFO] -   验证 - Loss: 0.353395, AUC: 0.9725, Acc: 0.9131
2025-09-01 12:26:54 - [INFO] -   时间 - 训练: 580.4s, 验证: 65.3s, 总计: 645.8s
2025-09-01 12:26:54 - [INFO] -   学习率: 0.000128
2025-09-01 12:26:54 - [INFO] -   *** 新的最佳验证AUC: 0.9725 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 12:26:54 - [INFO] - 
--- Epoch 8/60 ---
2025-09-01 12:26:54 - [INFO] - 当前学习率: 0.000146
2025-09-01 12:37:39 - [INFO] - Epoch 8 结果:
2025-09-01 12:37:39 - [INFO] -   训练 - Loss: 0.302803, AUC: 0.9822, Acc: 0.9384
2025-09-01 12:37:39 - [INFO] -   验证 - Loss: 0.382811, AUC: 0.9702, Acc: 0.9022
2025-09-01 12:37:39 - [INFO] -   时间 - 训练: 579.9s, 验证: 65.3s, 总计: 645.3s
2025-09-01 12:37:39 - [INFO] -   学习率: 0.000146
2025-09-01 12:37:39 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-01 12:37:39 - [INFO] - 
--- Epoch 9/60 ---
2025-09-01 12:37:39 - [INFO] - 当前学习率: 0.000164
2025-09-01 12:48:31 - [INFO] - Epoch 9 结果:
2025-09-01 12:48:31 - [INFO] -   训练 - Loss: 0.301593, AUC: 0.9828, Acc: 0.9380
2025-09-01 12:48:31 - [INFO] -   验证 - Loss: 0.363749, AUC: 0.9770, Acc: 0.9068
2025-09-01 12:48:31 - [INFO] -   时间 - 训练: 579.4s, 验证: 72.5s, 总计: 652.0s
2025-09-01 12:48:31 - [INFO] -   学习率: 0.000164
2025-09-01 12:48:31 - [INFO] -   *** 新的最佳验证AUC: 0.9770 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 12:48:31 - [INFO] - 
--- Epoch 10/60 ---
2025-09-01 12:48:31 - [INFO] - 当前学习率: 0.000182
2025-09-01 12:59:18 - [INFO] - Epoch 10 结果:
2025-09-01 12:59:18 - [INFO] -   训练 - Loss: 0.303492, AUC: 0.9821, Acc: 0.9368
2025-09-01 12:59:18 - [INFO] -   验证 - Loss: 0.344412, AUC: 0.9738, Acc: 0.9193
2025-09-01 12:59:18 - [INFO] -   时间 - 训练: 581.4s, 验证: 65.1s, 总计: 646.5s
2025-09-01 12:59:18 - [INFO] -   学习率: 0.000182
2025-09-01 12:59:18 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-01 12:59:18 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_epoch_10.pth
2025-09-01 12:59:18 - [INFO] - 
--- Epoch 11/60 ---
2025-09-01 12:59:18 - [INFO] - 当前学习率: 0.000200
2025-09-01 13:10:04 - [INFO] - Epoch 11 结果:
2025-09-01 13:10:04 - [INFO] -   训练 - Loss: 0.303547, AUC: 0.9818, Acc: 0.9372
2025-09-01 13:10:04 - [INFO] -   验证 - Loss: 0.404204, AUC: 0.9592, Acc: 0.8917
2025-09-01 13:10:04 - [INFO] -   时间 - 训练: 580.3s, 验证: 65.3s, 总计: 645.6s
2025-09-01 13:10:04 - [INFO] -   学习率: 0.000200
2025-09-01 13:10:04 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-09-01 13:10:04 - [INFO] - 
--- Epoch 12/60 ---
2025-09-01 13:10:04 - [INFO] - 当前学习率: 0.000200
2025-09-01 13:20:49 - [INFO] - Epoch 12 结果:
2025-09-01 13:20:49 - [INFO] -   训练 - Loss: 0.297390, AUC: 0.9836, Acc: 0.9409
2025-09-01 13:20:49 - [INFO] -   验证 - Loss: 0.373528, AUC: 0.9744, Acc: 0.9035
2025-09-01 13:20:49 - [INFO] -   时间 - 训练: 579.9s, 验证: 65.3s, 总计: 645.2s
2025-09-01 13:20:49 - [INFO] -   学习率: 0.000200
2025-09-01 13:20:49 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-09-01 13:20:49 - [INFO] - 
--- Epoch 13/60 ---
2025-09-01 13:20:49 - [INFO] - 当前学习率: 0.000199
2025-09-01 13:31:34 - [INFO] - Epoch 13 结果:
2025-09-01 13:31:34 - [INFO] -   训练 - Loss: 0.293525, AUC: 0.9843, Acc: 0.9438
2025-09-01 13:31:34 - [INFO] -   验证 - Loss: 0.346925, AUC: 0.9718, Acc: 0.9151
2025-09-01 13:31:34 - [INFO] -   时间 - 训练: 579.9s, 验证: 65.6s, 总计: 645.6s
2025-09-01 13:31:34 - [INFO] -   学习率: 0.000199
2025-09-01 13:31:34 - [INFO] -   验证AUC未改善，连续4轮未提升
2025-09-01 13:31:34 - [INFO] - 
--- Epoch 14/60 ---
2025-09-01 13:31:34 - [INFO] - 当前学习率: 0.000199
2025-09-01 13:42:19 - [INFO] - Epoch 14 结果:
2025-09-01 13:42:19 - [INFO] -   训练 - Loss: 0.286702, AUC: 0.9865, Acc: 0.9483
2025-09-01 13:42:19 - [INFO] -   验证 - Loss: 0.408393, AUC: 0.9696, Acc: 0.8975
2025-09-01 13:42:19 - [INFO] -   时间 - 训练: 579.3s, 验证: 65.3s, 总计: 644.7s
2025-09-01 13:42:19 - [INFO] -   学习率: 0.000199
2025-09-01 13:42:19 - [INFO] -   验证AUC未改善，连续5轮未提升
2025-09-01 13:42:19 - [INFO] - 
--- Epoch 15/60 ---
2025-09-01 13:42:19 - [INFO] - 当前学习率: 0.000198
2025-09-01 13:53:04 - [INFO] - Epoch 15 结果:
2025-09-01 13:53:04 - [INFO] -   训练 - Loss: 0.284070, AUC: 0.9873, Acc: 0.9500
2025-09-01 13:53:04 - [INFO] -   验证 - Loss: 0.399026, AUC: 0.9751, Acc: 0.9055
2025-09-01 13:53:04 - [INFO] -   时间 - 训练: 579.2s, 验证: 65.3s, 总计: 644.6s
2025-09-01 13:53:04 - [INFO] -   学习率: 0.000198
2025-09-01 13:53:04 - [INFO] -   验证AUC未改善，连续6轮未提升
2025-09-01 13:53:04 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_epoch_15.pth
2025-09-01 13:53:04 - [INFO] - 
--- Epoch 16/60 ---
2025-09-01 13:53:04 - [INFO] - 当前学习率: 0.000197
2025-09-01 14:04:05 - [INFO] - Epoch 16 结果:
2025-09-01 14:04:05 - [INFO] -   训练 - Loss: 0.279049, AUC: 0.9887, Acc: 0.9529
2025-09-01 14:04:05 - [INFO] -   验证 - Loss: 0.363421, AUC: 0.9685, Acc: 0.9098
2025-09-01 14:04:05 - [INFO] -   时间 - 训练: 593.5s, 验证: 67.5s, 总计: 661.0s
2025-09-01 14:04:05 - [INFO] -   学习率: 0.000197
2025-09-01 14:04:05 - [INFO] -   验证AUC未改善，连续7轮未提升
2025-09-01 14:04:05 - [INFO] - 
--- Epoch 17/60 ---
2025-09-01 14:04:05 - [INFO] - 当前学习率: 0.000195
2025-09-01 14:15:20 - [INFO] - Epoch 17 结果:
2025-09-01 14:15:20 - [INFO] -   训练 - Loss: 0.275170, AUC: 0.9897, Acc: 0.9551
2025-09-01 14:15:20 - [INFO] -   验证 - Loss: 0.351139, AUC: 0.9722, Acc: 0.9164
2025-09-01 14:15:20 - [INFO] -   时间 - 训练: 606.5s, 验证: 68.2s, 总计: 674.8s
2025-09-01 14:15:20 - [INFO] -   学习率: 0.000195
2025-09-01 14:15:20 - [INFO] -   验证AUC未改善，连续8轮未提升
2025-09-01 14:15:20 - [INFO] - 
--- Epoch 18/60 ---
2025-09-01 14:15:20 - [INFO] - 当前学习率: 0.000193
2025-09-01 14:26:26 - [INFO] - Epoch 18 结果:
2025-09-01 14:26:26 - [INFO] -   训练 - Loss: 0.272695, AUC: 0.9900, Acc: 0.9569
2025-09-01 14:26:26 - [INFO] -   验证 - Loss: 0.339979, AUC: 0.9777, Acc: 0.9225
2025-09-01 14:26:26 - [INFO] -   时间 - 训练: 599.5s, 验证: 67.1s, 总计: 666.7s
2025-09-01 14:26:26 - [INFO] -   学习率: 0.000193
2025-09-01 14:26:27 - [INFO] -   *** 新的最佳验证AUC: 0.9777 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 14:26:27 - [INFO] - 
--- Epoch 19/60 ---
2025-09-01 14:26:27 - [INFO] - 当前学习率: 0.000191
2025-09-01 14:37:31 - [INFO] - Epoch 19 结果:
2025-09-01 14:37:31 - [INFO] -   训练 - Loss: 0.267555, AUC: 0.9915, Acc: 0.9600
2025-09-01 14:37:31 - [INFO] -   验证 - Loss: 0.336498, AUC: 0.9751, Acc: 0.9167
2025-09-01 14:37:31 - [INFO] -   时间 - 训练: 597.1s, 验证: 67.4s, 总计: 664.6s
2025-09-01 14:37:31 - [INFO] -   学习率: 0.000191
2025-09-01 14:37:31 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-01 14:37:31 - [INFO] - 
--- Epoch 20/60 ---
2025-09-01 14:37:31 - [INFO] - 当前学习率: 0.000189

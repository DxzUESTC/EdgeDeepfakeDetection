2025-09-01 14:43:08 - [INFO] - 日志文件保存位置: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer\train_log_20250901_144308.txt
2025-09-01 14:43:08 - [INFO] - ================================================================================
2025-09-01 14:43:08 - [INFO] - Swin Transformer Tiny Deepfake Detection Training
2025-09-01 14:43:08 - [INFO] - 开始时间: 2025-09-01 14:43:08
2025-09-01 14:43:08 - [INFO] - ================================================================================
2025-09-01 14:43:08 - [INFO] - 路径配置:
2025-09-01 14:43:08 - [INFO] -   - 基础目录: D:\09_Project\EdgeDeepfakeDetection
2025-09-01 14:43:08 - [INFO] -   - 元数据文件: D:\09_Project\EdgeDeepfakeDetection\data\datasets\metadata\video_metadata_c23.csv
2025-09-01 14:43:08 - [INFO] -   - 人脸数据目录: D:\09_Project\EdgeDeepfakeDetection\data\preprocessed\faces_224
2025-09-01 14:43:08 - [INFO] -   - 日志保存目录: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer
2025-09-01 14:43:08 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune
2025-09-01 14:43:08 - [INFO] - 训练参数配置:
2025-09-01 14:43:08 - [INFO] -   - 随机种子: 42
2025-09-01 14:43:08 - [INFO] -   - 批次大小: 32
2025-09-01 14:43:08 - [INFO] -   - 工作进程数: 4
2025-09-01 14:43:08 - [INFO] -   - 训练轮数: 60
2025-09-01 14:43:08 - [INFO] -   - 早停patience: 10
2025-09-01 14:43:08 - [INFO] -   - 学习率: 0.0001
2025-09-01 14:43:08 - [INFO] -   - 权重衰减: 0.05
2025-09-01 14:43:08 - [INFO] - 所有路径检查通过 ✓
2025-09-01 14:43:08 - [INFO] - 正在加载数据集...
2025-09-01 14:43:09 - [INFO] - 数据集加载成功:
2025-09-01 14:43:09 - [INFO] -   - 训练集样本数: 70000
2025-09-01 14:43:09 - [INFO] -   - 验证集样本数: 15000
2025-09-01 14:43:09 - [INFO] -   - 测试集样本数: 15000
2025-09-01 14:43:09 - [INFO] - 标签分布统计:
2025-09-01 14:43:09 - [INFO] -   - 训练集 Real: 35000, Fake: 35000
2025-09-01 14:43:09 - [INFO] -   - 验证集 Real: 7500, Fake: 7500
2025-09-01 14:43:09 - [INFO] -   - 测试集 Real: 7500, Fake: 7500
2025-09-01 14:43:09 - [INFO] - 数据加载器配置: batch_size=32, num_workers=4
2025-09-01 14:43:09 - [INFO] - 正在验证数据加载...
2025-09-01 14:43:31 - [INFO] - 样本批次形状: inputs=torch.Size([32, 3, 224, 224]), labels=torch.Size([32])
2025-09-01 14:43:31 - [INFO] - 输入数据统计: mean=0.0637, std=0.9585
2025-09-01 14:43:31 - [INFO] - 输入数据范围: min=-2.1179, max=2.6400
2025-09-01 14:43:31 - [INFO] - 标签分布: tensor([16, 16])
2025-09-01 14:43:31 - [INFO] - ✓ 数据验证完成
2025-09-01 14:43:31 - [INFO] - 正在初始化Swin Transformer Tiny模型...
2025-09-01 14:43:33 - [INFO] - 已加载预训练的Swin Transformer Tiny模型
2025-09-01 14:43:33 - [INFO] - 模型结构: swin_tiny_patch4_window7_224 + Dropout(0.3)
2025-09-01 14:43:33 - [INFO] - 验证预训练权重加载状态...
2025-09-01 14:43:33 - [INFO] - 第一层权重统计: mean=0.000524, std=0.053220
2025-09-01 14:43:33 - [INFO] - ✓ 权重已正确初始化
2025-09-01 14:43:33 - [INFO] - 使用设备: cuda
2025-09-01 14:43:33 - [INFO] - CUDA设备信息: NVIDIA GeForce RTX 3070 Ti Laptop GPU
2025-09-01 14:43:33 - [INFO] - GPU内存: 8.0 GB
2025-09-01 14:43:33 - [INFO] - 优化器配置:
2025-09-01 14:43:33 - [INFO] -   - 优化器: AdamW
2025-09-01 14:43:33 - [INFO] -   - 初始学习率: 0.0001
2025-09-01 14:43:33 - [INFO] -   - 最小学习率: 1e-6
2025-09-01 14:43:33 - [INFO] -   - 权重衰减: 0.05
2025-09-01 14:43:33 - [INFO] -   - 调度器: Warmup(5) + CosineAnnealingLR(T_max=60)
2025-09-01 14:43:33 - [INFO] -   - 损失函数: CrossEntropyLoss (label_smoothing=0.1)
2025-09-01 14:43:33 - [INFO] -   - 分类头Dropout: 0.3
2025-09-01 14:43:33 - [INFO] - ============================================================
2025-09-01 14:43:33 - [INFO] - 开始训练模型
2025-09-01 14:43:33 - [INFO] - ============================================================
2025-09-01 14:43:33 - [INFO] - 模型总参数数量: 27,520,892
2025-09-01 14:43:33 - [INFO] - 可训练参数数量: 27,520,892
2025-09-01 14:43:33 - [INFO] - 训练配置:
2025-09-01 14:43:33 - [INFO] -   - 总epochs: 60
2025-09-01 14:43:33 - [INFO] -   - 早停patience: 10
2025-09-01 14:43:33 - [INFO] -   - 学习率: 1e-05
2025-09-01 14:43:33 - [INFO] -   - 权重衰减: 0.05
2025-09-01 14:43:33 - [INFO] -   - 批次大小: 32
2025-09-01 14:43:33 - [INFO] -   - 训练样本数: 70000
2025-09-01 14:43:33 - [INFO] -   - 验证样本数: 15000
2025-09-01 14:43:33 - [INFO] -   - 设备: cuda:0
2025-09-01 14:43:33 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune
2025-09-01 14:43:33 - [INFO] -   - PyTorch随机种子: 42
2025-09-01 14:43:33 - [INFO] -   - CUDA随机种子: 42
2025-09-01 14:43:33 - [INFO] -   - CUDNN确定性: True
2025-09-01 14:43:33 - [INFO] -   - CUDNN基准测试: False
2025-09-01 14:43:33 - [INFO] - Swin Transformer 使用端到端训练，无需冻结层
2025-09-01 14:43:33 - [INFO] - 
--- Epoch 1/60 ---
2025-09-01 14:43:33 - [INFO] - 当前学习率: 0.000010
2025-09-01 14:54:18 - [INFO] - Epoch 1 结果:
2025-09-01 14:54:18 - [INFO] -   训练 - Loss: 0.473675, AUC: 0.8960, Acc: 0.8064
2025-09-01 14:54:18 - [INFO] -   验证 - Loss: 0.468846, AUC: 0.9408, Acc: 0.8423
2025-09-01 14:54:18 - [INFO] -   时间 - 训练: 580.4s, 验证: 64.7s, 总计: 645.2s
2025-09-01 14:54:18 - [INFO] -   学习率: 0.000010
2025-09-01 14:54:18 - [INFO] -   *** 新的最佳验证AUC: 0.9408 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 14:54:18 - [INFO] - 
--- Epoch 2/60 ---
2025-09-01 14:54:18 - [INFO] - 当前学习率: 0.000028
2025-09-01 15:05:10 - [INFO] - Epoch 2 结果:
2025-09-01 15:05:10 - [INFO] -   训练 - Loss: 0.362707, AUC: 0.9607, Acc: 0.8960
2025-09-01 15:05:10 - [INFO] -   验证 - Loss: 0.381610, AUC: 0.9604, Acc: 0.8973
2025-09-01 15:05:10 - [INFO] -   时间 - 训练: 583.9s, 验证: 67.4s, 总计: 651.4s
2025-09-01 15:05:10 - [INFO] -   学习率: 0.000028
2025-09-01 15:05:10 - [INFO] -   *** 新的最佳验证AUC: 0.9604 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 15:05:10 - [INFO] - 
--- Epoch 3/60 ---
2025-09-01 15:05:10 - [INFO] - 当前学习率: 0.000046
2025-09-01 15:16:25 - [INFO] - Epoch 3 结果:
2025-09-01 15:16:25 - [INFO] -   训练 - Loss: 0.329223, AUC: 0.9736, Acc: 0.9203
2025-09-01 15:16:25 - [INFO] -   验证 - Loss: 0.386899, AUC: 0.9607, Acc: 0.8904
2025-09-01 15:16:25 - [INFO] -   时间 - 训练: 606.9s, 验证: 68.2s, 总计: 675.1s
2025-09-01 15:16:25 - [INFO] -   学习率: 0.000046
2025-09-01 15:16:25 - [INFO] -   *** 新的最佳验证AUC: 0.9607 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 15:16:25 - [INFO] - 
--- Epoch 4/60 ---
2025-09-01 15:16:25 - [INFO] - 当前学习率: 0.000064
2025-09-01 15:27:43 - [INFO] - Epoch 4 结果:
2025-09-01 15:27:43 - [INFO] -   训练 - Loss: 0.313789, AUC: 0.9791, Acc: 0.9307
2025-09-01 15:27:43 - [INFO] -   验证 - Loss: 0.417837, AUC: 0.9680, Acc: 0.8854
2025-09-01 15:27:43 - [INFO] -   时间 - 训练: 607.7s, 验证: 69.7s, 总计: 677.4s
2025-09-01 15:27:43 - [INFO] -   学习率: 0.000064
2025-09-01 15:27:43 - [INFO] -   *** 新的最佳验证AUC: 0.9680 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 15:27:43 - [INFO] - 
--- Epoch 5/60 ---
2025-09-01 15:27:43 - [INFO] - 当前学习率: 0.000082
2025-09-01 15:38:57 - [INFO] - Epoch 5 结果:
2025-09-01 15:38:57 - [INFO] -   训练 - Loss: 0.307060, AUC: 0.9810, Acc: 0.9361
2025-09-01 15:38:57 - [INFO] -   验证 - Loss: 0.391295, AUC: 0.9617, Acc: 0.8926
2025-09-01 15:38:57 - [INFO] -   时间 - 训练: 606.8s, 验证: 67.3s, 总计: 674.1s
2025-09-01 15:38:57 - [INFO] -   学习率: 0.000082
2025-09-01 15:38:57 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-01 15:38:57 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_epoch_5.pth
2025-09-01 15:38:57 - [INFO] - 
--- Epoch 6/60 ---
2025-09-01 15:38:57 - [INFO] - 当前学习率: 0.000100
2025-09-01 15:50:11 - [INFO] - Epoch 6 结果:
2025-09-01 15:50:11 - [INFO] -   训练 - Loss: 0.304354, AUC: 0.9820, Acc: 0.9366
2025-09-01 15:50:11 - [INFO] -   验证 - Loss: 0.369764, AUC: 0.9666, Acc: 0.9007
2025-09-01 15:50:11 - [INFO] -   时间 - 训练: 605.7s, 验证: 68.0s, 总计: 673.8s
2025-09-01 15:50:11 - [INFO] -   学习率: 0.000100
2025-09-01 15:50:11 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-09-01 15:50:11 - [INFO] - 
--- Epoch 7/60 ---
2025-09-01 15:50:11 - [INFO] - 当前学习率: 0.000100
2025-09-01 16:01:24 - [INFO] - Epoch 7 结果:
2025-09-01 16:01:24 - [INFO] -   训练 - Loss: 0.291271, AUC: 0.9855, Acc: 0.9450
2025-09-01 16:01:24 - [INFO] -   验证 - Loss: 0.380663, AUC: 0.9703, Acc: 0.8992
2025-09-01 16:01:24 - [INFO] -   时间 - 训练: 605.7s, 验证: 67.4s, 总计: 673.1s
2025-09-01 16:01:24 - [INFO] -   学习率: 0.000100
2025-09-01 16:01:24 - [INFO] -   *** 新的最佳验证AUC: 0.9703 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 16:01:24 - [INFO] - 
--- Epoch 8/60 ---
2025-09-01 16:01:24 - [INFO] - 当前学习率: 0.000100
2025-09-01 16:12:39 - [INFO] - Epoch 8 结果:
2025-09-01 16:12:39 - [INFO] -   训练 - Loss: 0.284548, AUC: 0.9873, Acc: 0.9494
2025-09-01 16:12:39 - [INFO] -   验证 - Loss: 0.336096, AUC: 0.9759, Acc: 0.9213
2025-09-01 16:12:39 - [INFO] -   时间 - 训练: 606.4s, 验证: 68.4s, 总计: 674.8s
2025-09-01 16:12:39 - [INFO] -   学习率: 0.000100
2025-09-01 16:12:39 - [INFO] -   *** 新的最佳验证AUC: 0.9759 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 16:12:39 - [INFO] - 
--- Epoch 9/60 ---
2025-09-01 16:12:39 - [INFO] - 当前学习率: 0.000099
2025-09-01 16:23:54 - [INFO] - Epoch 9 结果:
2025-09-01 16:23:54 - [INFO] -   训练 - Loss: 0.276905, AUC: 0.9895, Acc: 0.9539
2025-09-01 16:23:54 - [INFO] -   验证 - Loss: 0.389858, AUC: 0.9725, Acc: 0.8981
2025-09-01 16:23:54 - [INFO] -   时间 - 训练: 607.2s, 验证: 67.6s, 总计: 674.8s
2025-09-01 16:23:54 - [INFO] -   学习率: 0.000099
2025-09-01 16:23:54 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-01 16:23:54 - [INFO] - 
--- Epoch 10/60 ---
2025-09-01 16:23:54 - [INFO] - 当前学习率: 0.000099
2025-09-01 16:35:07 - [INFO] - Epoch 10 结果:
2025-09-01 16:35:07 - [INFO] -   训练 - Loss: 0.273827, AUC: 0.9899, Acc: 0.9560
2025-09-01 16:35:07 - [INFO] -   验证 - Loss: 0.329799, AUC: 0.9784, Acc: 0.9253
2025-09-01 16:35:07 - [INFO] -   时间 - 训练: 605.8s, 验证: 67.3s, 总计: 673.2s
2025-09-01 16:35:07 - [INFO] -   学习率: 0.000099
2025-09-01 16:35:07 - [INFO] -   *** 新的最佳验证AUC: 0.9784 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 16:35:07 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_epoch_10.pth
2025-09-01 16:35:07 - [INFO] - 
--- Epoch 11/60 ---
2025-09-01 16:35:07 - [INFO] - 当前学习率: 0.000098
2025-09-01 16:46:20 - [INFO] - Epoch 11 结果:
2025-09-01 16:46:20 - [INFO] -   训练 - Loss: 0.270152, AUC: 0.9910, Acc: 0.9583
2025-09-01 16:46:20 - [INFO] -   验证 - Loss: 0.357301, AUC: 0.9716, Acc: 0.9111
2025-09-01 16:46:20 - [INFO] -   时间 - 训练: 605.6s, 验证: 67.3s, 总计: 672.9s
2025-09-01 16:46:20 - [INFO] -   学习率: 0.000098
2025-09-01 16:46:20 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-01 16:46:20 - [INFO] - 
--- Epoch 12/60 ---
2025-09-01 16:46:20 - [INFO] - 当前学习率: 0.000098
2025-09-01 16:57:35 - [INFO] - Epoch 12 结果:
2025-09-01 16:57:35 - [INFO] -   训练 - Loss: 0.264340, AUC: 0.9917, Acc: 0.9624
2025-09-01 16:57:35 - [INFO] -   验证 - Loss: 0.388319, AUC: 0.9776, Acc: 0.8997
2025-09-01 16:57:35 - [INFO] -   时间 - 训练: 606.6s, 验证: 68.2s, 总计: 674.9s
2025-09-01 16:57:35 - [INFO] -   学习率: 0.000098
2025-09-01 16:57:35 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-09-01 16:57:35 - [INFO] - 
--- Epoch 13/60 ---
2025-09-01 16:57:35 - [INFO] - 当前学习率: 0.000097
2025-09-01 17:08:50 - [INFO] - Epoch 13 结果:
2025-09-01 17:08:50 - [INFO] -   训练 - Loss: 0.260441, AUC: 0.9931, Acc: 0.9645
2025-09-01 17:08:50 - [INFO] -   验证 - Loss: 0.350739, AUC: 0.9756, Acc: 0.9217
2025-09-01 17:08:50 - [INFO] -   时间 - 训练: 606.3s, 验证: 68.1s, 总计: 674.5s
2025-09-01 17:08:50 - [INFO] -   学习率: 0.000097
2025-09-01 17:08:50 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-09-01 17:08:50 - [INFO] - 
--- Epoch 14/60 ---
2025-09-01 17:08:50 - [INFO] - 当前学习率: 0.000096
2025-09-01 17:20:05 - [INFO] - Epoch 14 结果:
2025-09-01 17:20:05 - [INFO] -   训练 - Loss: 0.258526, AUC: 0.9937, Acc: 0.9655
2025-09-01 17:20:05 - [INFO] -   验证 - Loss: 0.340385, AUC: 0.9814, Acc: 0.9258
2025-09-01 17:20:05 - [INFO] -   时间 - 训练: 606.8s, 验证: 68.0s, 总计: 674.9s
2025-09-01 17:20:05 - [INFO] -   学习率: 0.000096
2025-09-01 17:20:05 - [INFO] -   *** 新的最佳验证AUC: 0.9814 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 17:20:05 - [INFO] - 
--- Epoch 15/60 ---
2025-09-01 17:20:05 - [INFO] - 当前学习率: 0.000095
2025-09-01 17:31:20 - [INFO] - Epoch 15 结果:
2025-09-01 17:31:20 - [INFO] -   训练 - Loss: 0.255109, AUC: 0.9938, Acc: 0.9675
2025-09-01 17:31:20 - [INFO] -   验证 - Loss: 0.359188, AUC: 0.9765, Acc: 0.9183
2025-09-01 17:31:20 - [INFO] -   时间 - 训练: 607.5s, 验证: 67.7s, 总计: 675.3s
2025-09-01 17:31:20 - [INFO] -   学习率: 0.000095
2025-09-01 17:31:20 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-01 17:31:20 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_epoch_15.pth
2025-09-01 17:31:20 - [INFO] - 
--- Epoch 16/60 ---
2025-09-01 17:31:20 - [INFO] - 当前学习率: 0.000093
2025-09-01 17:42:20 - [INFO] - Epoch 16 结果:
2025-09-01 17:42:20 - [INFO] -   训练 - Loss: 0.252596, AUC: 0.9943, Acc: 0.9696
2025-09-01 17:42:20 - [INFO] -   验证 - Loss: 0.354392, AUC: 0.9742, Acc: 0.9184
2025-09-01 17:42:20 - [INFO] -   时间 - 训练: 594.5s, 验证: 65.4s, 总计: 659.9s
2025-09-01 17:42:20 - [INFO] -   学习率: 0.000093
2025-09-01 17:42:20 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-09-01 17:42:20 - [INFO] - 
--- Epoch 17/60 ---
2025-09-01 17:42:20 - [INFO] - 当前学习率: 0.000092
2025-09-01 17:53:04 - [INFO] - Epoch 17 结果:
2025-09-01 17:53:04 - [INFO] -   训练 - Loss: 0.249011, AUC: 0.9949, Acc: 0.9718
2025-09-01 17:53:04 - [INFO] -   验证 - Loss: 0.366786, AUC: 0.9743, Acc: 0.9137
2025-09-01 17:53:04 - [INFO] -   时间 - 训练: 578.5s, 验证: 65.4s, 总计: 644.0s
2025-09-01 17:53:04 - [INFO] -   学习率: 0.000092
2025-09-01 17:53:04 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-09-01 17:53:04 - [INFO] - 
--- Epoch 18/60 ---
2025-09-01 17:53:04 - [INFO] - 当前学习率: 0.000091
2025-09-01 18:03:47 - [INFO] - Epoch 18 结果:
2025-09-01 18:03:47 - [INFO] -   训练 - Loss: 0.249102, AUC: 0.9952, Acc: 0.9711
2025-09-01 18:03:47 - [INFO] -   验证 - Loss: 0.338235, AUC: 0.9785, Acc: 0.9279
2025-09-01 18:03:47 - [INFO] -   时间 - 训练: 577.8s, 验证: 65.1s, 总计: 642.9s
2025-09-01 18:03:47 - [INFO] -   学习率: 0.000091
2025-09-01 18:03:47 - [INFO] -   验证AUC未改善，连续4轮未提升
2025-09-01 18:03:47 - [INFO] - 
--- Epoch 19/60 ---
2025-09-01 18:03:47 - [INFO] - 当前学习率: 0.000089
2025-09-01 18:14:30 - [INFO] - Epoch 19 结果:
2025-09-01 18:14:30 - [INFO] -   训练 - Loss: 0.245730, AUC: 0.9959, Acc: 0.9729
2025-09-01 18:14:30 - [INFO] -   验证 - Loss: 0.336113, AUC: 0.9781, Acc: 0.9295
2025-09-01 18:14:30 - [INFO] -   时间 - 训练: 578.1s, 验证: 65.0s, 总计: 643.1s
2025-09-01 18:14:30 - [INFO] -   学习率: 0.000089
2025-09-01 18:14:30 - [INFO] -   验证AUC未改善，连续5轮未提升
2025-09-01 18:14:30 - [INFO] - 
--- Epoch 20/60 ---
2025-09-01 18:14:30 - [INFO] - 当前学习率: 0.000087
2025-09-01 18:25:15 - [INFO] - Epoch 20 结果:
2025-09-01 18:25:15 - [INFO] -   训练 - Loss: 0.244462, AUC: 0.9959, Acc: 0.9740
2025-09-01 18:25:15 - [INFO] -   验证 - Loss: 0.344956, AUC: 0.9816, Acc: 0.9225
2025-09-01 18:25:15 - [INFO] -   时间 - 训练: 579.6s, 验证: 65.0s, 总计: 644.7s
2025-09-01 18:25:15 - [INFO] -   学习率: 0.000087
2025-09-01 18:25:15 - [INFO] -   *** 新的最佳验证AUC: 0.9816 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth ***
2025-09-01 18:25:15 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_epoch_20.pth
2025-09-01 18:25:15 - [INFO] - 
--- Epoch 21/60 ---
2025-09-01 18:25:15 - [INFO] - 当前学习率: 0.000086
2025-09-01 18:36:00 - [INFO] - Epoch 21 结果:
2025-09-01 18:36:00 - [INFO] -   训练 - Loss: 0.242368, AUC: 0.9964, Acc: 0.9747
2025-09-01 18:36:00 - [INFO] -   验证 - Loss: 0.355592, AUC: 0.9714, Acc: 0.9201
2025-09-01 18:36:00 - [INFO] -   时间 - 训练: 580.3s, 验证: 65.0s, 总计: 645.3s
2025-09-01 18:36:00 - [INFO] -   学习率: 0.000086
2025-09-01 18:36:00 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-09-01 18:36:00 - [INFO] - 
--- Epoch 22/60 ---
2025-09-01 18:36:00 - [INFO] - 当前学习率: 0.000084
2025-09-01 18:46:46 - [INFO] - Epoch 22 结果:
2025-09-01 18:46:46 - [INFO] -   训练 - Loss: 0.241347, AUC: 0.9964, Acc: 0.9759
2025-09-01 18:46:46 - [INFO] -   验证 - Loss: 0.341305, AUC: 0.9789, Acc: 0.9291
2025-09-01 18:46:46 - [INFO] -   时间 - 训练: 580.1s, 验证: 65.0s, 总计: 645.2s
2025-09-01 18:46:46 - [INFO] -   学习率: 0.000084
2025-09-01 18:46:46 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-09-01 18:46:46 - [INFO] - 
--- Epoch 23/60 ---
2025-09-01 18:46:46 - [INFO] - 当前学习率: 0.000082
2025-09-01 18:57:30 - [INFO] - Epoch 23 结果:
2025-09-01 18:57:30 - [INFO] -   训练 - Loss: 0.240001, AUC: 0.9966, Acc: 0.9765
2025-09-01 18:57:30 - [INFO] -   验证 - Loss: 0.350120, AUC: 0.9776, Acc: 0.9283
2025-09-01 18:57:30 - [INFO] -   时间 - 训练: 579.0s, 验证: 65.3s, 总计: 644.3s
2025-09-01 18:57:30 - [INFO] -   学习率: 0.000082
2025-09-01 18:57:30 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-09-01 18:57:30 - [INFO] - 
--- Epoch 24/60 ---
2025-09-01 18:57:30 - [INFO] - 当前学习率: 0.000080
2025-09-01 19:08:16 - [INFO] - Epoch 24 结果:
2025-09-01 19:08:16 - [INFO] -   训练 - Loss: 0.237321, AUC: 0.9971, Acc: 0.9782
2025-09-01 19:08:16 - [INFO] -   验证 - Loss: 0.366603, AUC: 0.9717, Acc: 0.9199
2025-09-01 19:08:16 - [INFO] -   时间 - 训练: 579.9s, 验证: 65.9s, 总计: 645.8s
2025-09-01 19:08:16 - [INFO] -   学习率: 0.000080
2025-09-01 19:08:16 - [INFO] -   验证AUC未改善，连续4轮未提升
2025-09-01 19:08:16 - [INFO] - 
--- Epoch 25/60 ---
2025-09-01 19:08:16 - [INFO] - 当前学习率: 0.000077
2025-09-01 19:18:59 - [INFO] - Epoch 25 结果:
2025-09-01 19:18:59 - [INFO] -   训练 - Loss: 0.236874, AUC: 0.9972, Acc: 0.9783
2025-09-01 19:18:59 - [INFO] -   验证 - Loss: 0.352250, AUC: 0.9778, Acc: 0.9262
2025-09-01 19:18:59 - [INFO] -   时间 - 训练: 578.3s, 验证: 65.1s, 总计: 643.5s
2025-09-01 19:18:59 - [INFO] -   学习率: 0.000077
2025-09-01 19:18:59 - [INFO] -   验证AUC未改善，连续5轮未提升
2025-09-01 19:18:59 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_epoch_25.pth
2025-09-01 19:18:59 - [INFO] - 
--- Epoch 26/60 ---
2025-09-01 19:18:59 - [INFO] - 当前学习率: 0.000075
2025-09-01 19:29:45 - [INFO] - Epoch 26 结果:
2025-09-01 19:29:45 - [INFO] -   训练 - Loss: 0.233612, AUC: 0.9977, Acc: 0.9798
2025-09-01 19:29:45 - [INFO] -   验证 - Loss: 0.341608, AUC: 0.9745, Acc: 0.9303
2025-09-01 19:29:45 - [INFO] -   时间 - 训练: 580.1s, 验证: 65.2s, 总计: 645.4s
2025-09-01 19:29:45 - [INFO] -   学习率: 0.000075
2025-09-01 19:29:45 - [INFO] -   验证AUC未改善，连续6轮未提升
2025-09-01 19:29:45 - [INFO] - 
--- Epoch 27/60 ---
2025-09-01 19:29:45 - [INFO] - 当前学习率: 0.000073
2025-09-01 19:40:30 - [INFO] - Epoch 27 结果:
2025-09-01 19:40:30 - [INFO] -   训练 - Loss: 0.231996, AUC: 0.9977, Acc: 0.9815
2025-09-01 19:40:30 - [INFO] -   验证 - Loss: 0.372396, AUC: 0.9722, Acc: 0.9159
2025-09-01 19:40:30 - [INFO] -   时间 - 训练: 579.8s, 验证: 65.2s, 总计: 645.1s
2025-09-01 19:40:30 - [INFO] -   学习率: 0.000073
2025-09-01 19:40:30 - [INFO] -   验证AUC未改善，连续7轮未提升
2025-09-01 19:40:30 - [INFO] - 
--- Epoch 28/60 ---
2025-09-01 19:40:30 - [INFO] - 当前学习率: 0.000071
2025-09-01 19:51:16 - [INFO] - Epoch 28 结果:
2025-09-01 19:51:16 - [INFO] -   训练 - Loss: 0.230973, AUC: 0.9977, Acc: 0.9822
2025-09-01 19:51:16 - [INFO] -   验证 - Loss: 0.356231, AUC: 0.9753, Acc: 0.9273
2025-09-01 19:51:16 - [INFO] -   时间 - 训练: 580.9s, 验证: 65.1s, 总计: 646.0s
2025-09-01 19:51:16 - [INFO] -   学习率: 0.000071
2025-09-01 19:51:16 - [INFO] -   验证AUC未改善，连续8轮未提升
2025-09-01 19:51:16 - [INFO] - 
--- Epoch 29/60 ---
2025-09-01 19:51:16 - [INFO] - 当前学习率: 0.000068
2025-09-01 20:02:00 - [INFO] - Epoch 29 结果:
2025-09-01 20:02:00 - [INFO] -   训练 - Loss: 0.229239, AUC: 0.9979, Acc: 0.9832
2025-09-01 20:02:00 - [INFO] -   验证 - Loss: 0.354657, AUC: 0.9784, Acc: 0.9279
2025-09-01 20:02:00 - [INFO] -   时间 - 训练: 578.3s, 验证: 65.5s, 总计: 644.0s
2025-09-01 20:02:00 - [INFO] -   学习率: 0.000068
2025-09-01 20:02:00 - [INFO] -   验证AUC未改善，连续9轮未提升
2025-09-01 20:02:00 - [INFO] - 
--- Epoch 30/60 ---
2025-09-01 20:02:00 - [INFO] - 当前学习率: 0.000066
2025-09-01 20:12:44 - [INFO] - Epoch 30 结果:
2025-09-01 20:12:44 - [INFO] -   训练 - Loss: 0.229685, AUC: 0.9980, Acc: 0.9824
2025-09-01 20:12:44 - [INFO] -   验证 - Loss: 0.328523, AUC: 0.9802, Acc: 0.9325
2025-09-01 20:12:44 - [INFO] -   时间 - 训练: 578.7s, 验证: 65.1s, 总计: 643.9s
2025-09-01 20:12:44 - [INFO] -   学习率: 0.000066
2025-09-01 20:12:44 - [INFO] -   验证AUC未改善，连续10轮未提升
2025-09-01 20:12:44 - [INFO] - 达到早停条件 (patience=10)，在epoch 30停止训练
2025-09-01 20:12:44 - [INFO] - ============================================================
2025-09-01 20:12:44 - [INFO] - 训练完成!
2025-09-01 20:12:44 - [INFO] - 最佳验证AUC: 0.9816
2025-09-01 20:12:44 - [INFO] - 总训练时间: 5.49 小时
2025-09-01 20:12:44 - [INFO] - 最佳模型保存位置: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune\swin_tiny_best.pth
2025-09-01 20:12:44 - [INFO] - ============================================================
2025-09-01 20:12:44 - [INFO] - 训练结束 - 最佳验证AUC: 0.9816
2025-09-01 20:12:44 - [INFO] - 
============================================================
2025-09-01 20:12:44 - [INFO] - 开始测试阶段 - 纯净性能（无H.264噪声）
2025-09-01 20:12:44 - [INFO] - ============================================================
2025-09-01 20:13:50 - [INFO] - 纯净测试结果:
2025-09-01 20:13:50 - [INFO] -   - 测试AUC: 0.9817
2025-09-01 20:13:50 - [INFO] -   - 测试准确率: 0.9235
2025-09-01 20:13:50 - [INFO] -   - 测试时间: 66.08秒
2025-09-01 20:13:50 - [INFO] -   - 测试样本数: 15000
2025-09-01 20:13:50 - [INFO] - 
============================================================
2025-09-01 20:13:50 - [INFO] - 开始测试阶段 - 噪声鲁棒性（含H.264噪声）
2025-09-01 20:13:50 - [INFO] - ============================================================
2025-09-01 20:14:56 - [INFO] - 噪声测试结果:
2025-09-01 20:14:56 - [INFO] -   - 测试AUC (噪声): 0.9422
2025-09-01 20:14:56 - [INFO] -   - 测试准确率 (噪声): 0.8594
2025-09-01 20:14:56 - [INFO] -   - 测试时间: 66.04秒
2025-09-01 20:14:56 - [INFO] -   - 鲁棒性评估 (AUC下降): 0.0395
2025-09-01 20:14:56 - [INFO] - 
================================================================================
2025-09-01 20:14:56 - [INFO] - 程序执行完成
2025-09-01 20:14:56 - [INFO] - 结束时间: 2025-09-01 20:14:56
2025-09-01 20:14:56 - [INFO] - 总执行时间: 5.53 小时
2025-09-01 20:14:56 - [INFO] - 
最终结果总结:
2025-09-01 20:14:56 - [INFO] -   - 最佳验证AUC: 0.9816
2025-09-01 20:14:56 - [INFO] -   - 纯净测试AUC: 0.9817
2025-09-01 20:14:56 - [INFO] -   - 噪声测试AUC: 0.9422
2025-09-01 20:14:56 - [INFO] -   - 噪声鲁棒性: 96.0%
2025-09-01 20:14:56 - [INFO] - ================================================================================

2025-09-03 10:15:42 - [INFO] - 日志文件保存位置: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer\train_log_20250903_101542.txt
2025-09-03 10:15:42 - [INFO] - ================================================================================
2025-09-03 10:15:42 - [INFO] - Swin Transformer Tiny Deepfake Detection Training
2025-09-03 10:15:42 - [INFO] - 开始时间: 2025-09-03 10:15:42
2025-09-03 10:15:42 - [INFO] - ================================================================================
2025-09-03 10:15:42 - [INFO] - 路径配置:
2025-09-03 10:15:42 - [INFO] -   - 基础目录: D:\09_Project\EdgeDeepfakeDetection
2025-09-03 10:15:42 - [INFO] -   - 元数据文件: D:\09_Project\EdgeDeepfakeDetection\data\datasets\metadata\video_metadata_c23.csv
2025-09-03 10:15:42 - [INFO] -   - 人脸数据目录: D:\09_Project\EdgeDeepfakeDetection\data\preprocessed\faces_224
2025-09-03 10:15:42 - [INFO] -   - 日志保存目录: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer
2025-09-03 10:15:42 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune
2025-09-03 10:15:42 - [INFO] - 训练参数配置:
2025-09-03 10:15:42 - [INFO] -   - 随机种子: 42
2025-09-03 10:15:42 - [INFO] -   - 批次大小: 32
2025-09-03 10:15:42 - [INFO] -   - 工作进程数: 4
2025-09-03 10:15:42 - [INFO] -   - 训练轮数: 75
2025-09-03 10:15:42 - [INFO] -   - 早停patience: 12
2025-09-03 10:15:42 - [INFO] -   - 学习率: 0.0001
2025-09-03 10:15:42 - [INFO] -   - 权重衰减: 0.05
2025-09-03 10:15:42 - [INFO] - 所有路径检查通过 ✓
2025-09-03 10:15:42 - [INFO] - 正在加载数据集...
2025-09-03 10:15:43 - [INFO] - 数据集加载成功:
2025-09-03 10:15:43 - [INFO] -   - 训练集样本数: 70000
2025-09-03 10:15:43 - [INFO] -   - 验证集样本数: 15000
2025-09-03 10:15:43 - [INFO] -   - 测试集样本数: 15000
2025-09-03 10:15:43 - [INFO] - 标签分布统计:
2025-09-03 10:15:43 - [INFO] -   - 训练集 Real: 35000, Fake: 35000
2025-09-03 10:15:43 - [INFO] -   - 验证集 Real: 7500, Fake: 7500
2025-09-03 10:15:43 - [INFO] -   - 测试集 Real: 7500, Fake: 7500
2025-09-03 10:15:43 - [INFO] - 数据加载器配置: batch_size=32, num_workers=4
2025-09-03 10:15:43 - [INFO] - 正在验证数据加载...
2025-09-03 10:16:05 - [INFO] - 样本批次形状: inputs=torch.Size([32, 3, 224, 224]), labels=torch.Size([32])
2025-09-03 10:16:05 - [INFO] - 输入数据统计: mean=0.0637, std=0.9585
2025-09-03 10:16:05 - [INFO] - 输入数据范围: min=-2.1179, max=2.6400
2025-09-03 10:16:05 - [INFO] - 标签分布: tensor([16, 16])
2025-09-03 10:16:05 - [INFO] - ✓ 数据验证完成
2025-09-03 10:16:05 - [INFO] - 正在初始化Swin Transformer Tiny模型...
2025-09-03 10:16:07 - [INFO] - 已加载预训练的Swin Transformer Tiny模型
2025-09-03 10:16:07 - [INFO] - 模型结构: swin_tiny_patch4_window7_224 + Dropout(0.1)
2025-09-03 10:16:07 - [INFO] - 验证预训练权重加载状态...
2025-09-03 10:16:07 - [INFO] - 第一层权重统计: mean=0.000524, std=0.053220
2025-09-03 10:16:07 - [INFO] - ✓ 权重已正确初始化
2025-09-03 10:16:07 - [INFO] - 使用设备: cuda
2025-09-03 10:16:07 - [INFO] - CUDA设备信息: NVIDIA GeForce RTX 3070 Ti Laptop GPU
2025-09-03 10:16:07 - [INFO] - GPU内存: 8.0 GB
2025-09-03 10:16:07 - [INFO] - 优化器配置:
2025-09-03 10:16:07 - [INFO] -   - 优化器: AdamW
2025-09-03 10:16:07 - [INFO] -   - 初始学习率: 0.0001
2025-09-03 10:16:07 - [INFO] -   - 最小学习率: 1e-5 (提高以保持后期优化能力)
2025-09-03 10:16:07 - [INFO] -   - 权重衰减: 0.05
2025-09-03 10:16:07 - [INFO] -   - 调度器: Warmup(2) + CosineAnnealingLR(T_max=75)
2025-09-03 10:16:07 - [INFO] -   - 损失函数: CrossEntropyLoss (移除label_smoothing追求更低Loss)
2025-09-03 10:16:07 - [INFO] -   - 分类头Dropout: 0.1 (降低以增强拟合能力)
2025-09-03 10:16:07 - [INFO] - ============================================================
2025-09-03 10:16:07 - [INFO] - 开始训练模型
2025-09-03 10:16:07 - [INFO] - ============================================================
2025-09-03 10:16:07 - [INFO] - 模型总参数数量: 27,520,892
2025-09-03 10:16:07 - [INFO] - 可训练参数数量: 27,520,892
2025-09-03 10:16:07 - [INFO] - 训练配置:
2025-09-03 10:16:07 - [INFO] -   - 总epochs: 75
2025-09-03 10:16:07 - [INFO] -   - 早停patience: 12
2025-09-03 10:16:07 - [INFO] -   - 学习率: 1e-05
2025-09-03 10:16:07 - [INFO] -   - 权重衰减: 0.05
2025-09-03 10:16:07 - [INFO] -   - 批次大小: 32
2025-09-03 10:16:07 - [INFO] -   - 训练样本数: 70000
2025-09-03 10:16:07 - [INFO] -   - 验证样本数: 15000
2025-09-03 10:16:07 - [INFO] -   - 设备: cuda:0
2025-09-03 10:16:07 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_finetune
2025-09-03 10:16:07 - [INFO] -   - PyTorch随机种子: 42
2025-09-03 10:16:08 - [INFO] -   - CUDA随机种子: 42
2025-09-03 10:16:08 - [INFO] -   - CUDNN确定性: True
2025-09-03 10:16:08 - [INFO] -   - CUDNN基准测试: False
2025-09-03 10:16:08 - [INFO] - Swin Transformer 使用端到端训练，无需冻结层
2025-09-03 10:16:08 - [INFO] - 
--- Epoch 1/75 ---
2025-09-03 10:16:08 - [INFO] - 当前学习率: 0.000010

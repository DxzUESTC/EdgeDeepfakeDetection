2025-08-29 15:03:54 - [INFO] - 日志文件保存位置: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer\train_log_20250829_150354.txt
2025-08-29 15:03:54 - [INFO] - ================================================================================
2025-08-29 15:03:54 - [INFO] - Swin Transformer Tiny Deepfake Detection Training
2025-08-29 15:03:54 - [INFO] - 开始时间: 2025-08-29 15:03:54
2025-08-29 15:03:54 - [INFO] - ================================================================================
2025-08-29 15:03:54 - [INFO] - 路径配置:
2025-08-29 15:03:54 - [INFO] -   - 基础目录: D:\09_Project\EdgeDeepfakeDetection
2025-08-29 15:03:54 - [INFO] -   - 元数据文件: D:\09_Project\EdgeDeepfakeDetection\data\datasets\metadata\video_metadata_c23.csv
2025-08-29 15:03:54 - [INFO] -   - 人脸数据目录: D:\09_Project\EdgeDeepfakeDetection\data\preprocessed\faces_224
2025-08-29 15:03:54 - [INFO] -   - 日志保存目录: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer
2025-08-29 15:03:54 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42
2025-08-29 15:03:54 - [INFO] - 训练参数配置:
2025-08-29 15:03:54 - [INFO] -   - 随机种子: 42
2025-08-29 15:03:54 - [INFO] -   - 批次大小: 32
2025-08-29 15:03:54 - [INFO] -   - 工作进程数: 4
2025-08-29 15:03:54 - [INFO] -   - 训练轮数: 50
2025-08-29 15:03:54 - [INFO] -   - 早停patience: 8
2025-08-29 15:03:54 - [INFO] -   - 学习率: 0.0001
2025-08-29 15:03:54 - [INFO] -   - 权重衰减: 0.05
2025-08-29 15:03:54 - [INFO] - 所有路径检查通过 ✓
2025-08-29 15:03:54 - [INFO] - 正在加载数据集...
2025-08-29 15:03:55 - [INFO] - 数据集加载成功:
2025-08-29 15:03:55 - [INFO] -   - 训练集样本数: 70000
2025-08-29 15:03:55 - [INFO] -   - 验证集样本数: 15000
2025-08-29 15:03:55 - [INFO] -   - 测试集样本数: 15000
2025-08-29 15:03:55 - [INFO] - 标签分布统计:
2025-08-29 15:03:55 - [INFO] -   - 训练集 Real: 35000, Fake: 35000
2025-08-29 15:03:55 - [INFO] -   - 验证集 Real: 7500, Fake: 7500
2025-08-29 15:03:55 - [INFO] -   - 测试集 Real: 7500, Fake: 7500
2025-08-29 15:03:55 - [INFO] - 数据加载器配置: batch_size=32, num_workers=4
2025-08-29 15:03:55 - [INFO] - 正在验证数据加载...
2025-08-29 15:04:13 - [INFO] - 样本批次形状: inputs=torch.Size([32, 3, 224, 224]), labels=torch.Size([32])
2025-08-29 15:04:13 - [INFO] - 输入数据统计: mean=0.0637, std=0.9585
2025-08-29 15:04:13 - [INFO] - 输入数据范围: min=-2.1179, max=2.6400
2025-08-29 15:04:13 - [INFO] - 标签分布: tensor([16, 16])
2025-08-29 15:04:13 - [INFO] - ✓ 数据验证完成
2025-08-29 15:04:13 - [INFO] - 正在初始化Swin Transformer Tiny模型...
2025-08-29 15:04:16 - [INFO] - 已加载预训练的Swin Transformer Tiny模型
2025-08-29 15:04:16 - [INFO] - 模型结构: swin_tiny_patch4_window7_224
2025-08-29 15:04:16 - [INFO] - 验证预训练权重加载状态...
2025-08-29 15:04:16 - [INFO] - 第一层权重统计: mean=0.000524, std=0.053220
2025-08-29 15:04:16 - [INFO] - ✓ 权重已正确初始化
2025-08-29 15:04:16 - [INFO] - 使用设备: cuda
2025-08-29 15:04:16 - [INFO] - CUDA设备信息: NVIDIA GeForce RTX 3070 Ti Laptop GPU
2025-08-29 15:04:16 - [INFO] - GPU内存: 8.0 GB
2025-08-29 15:04:16 - [INFO] - 优化器配置:
2025-08-29 15:04:16 - [INFO] -   - 优化器: AdamW
2025-08-29 15:04:16 - [INFO] -   - 初始学习率: 0.0001
2025-08-29 15:04:16 - [INFO] -   - 权重衰减: 0.05
2025-08-29 15:04:16 - [INFO] -   - 调度器: Warmup(5) + CosineAnnealingLR
2025-08-29 15:04:16 - [INFO] -   - 损失函数: CrossEntropyLoss (label_smoothing=0.1)
2025-08-29 15:04:16 - [INFO] - ============================================================
2025-08-29 15:04:16 - [INFO] - 开始训练模型
2025-08-29 15:04:16 - [INFO] - ============================================================
2025-08-29 15:04:16 - [INFO] - 模型总参数数量: 27,520,892
2025-08-29 15:04:16 - [INFO] - 可训练参数数量: 27,520,892
2025-08-29 15:04:16 - [INFO] - 训练配置:
2025-08-29 15:04:16 - [INFO] -   - 总epochs: 50
2025-08-29 15:04:16 - [INFO] -   - 早停patience: 8
2025-08-29 15:04:16 - [INFO] -   - 学习率: 1e-05
2025-08-29 15:04:16 - [INFO] -   - 权重衰减: 0.05
2025-08-29 15:04:16 - [INFO] -   - 批次大小: 32
2025-08-29 15:04:16 - [INFO] -   - 训练样本数: 70000
2025-08-29 15:04:16 - [INFO] -   - 验证样本数: 15000
2025-08-29 15:04:16 - [INFO] -   - 设备: cuda:0
2025-08-29 15:04:16 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42
2025-08-29 15:04:16 - [INFO] -   - PyTorch随机种子: 42
2025-08-29 15:04:16 - [INFO] -   - CUDA随机种子: 42
2025-08-29 15:04:16 - [INFO] -   - CUDNN确定性: True
2025-08-29 15:04:16 - [INFO] -   - CUDNN基准测试: False
2025-08-29 15:04:16 - [INFO] - Swin Transformer 使用端到端训练，无需冻结层
2025-08-29 15:04:16 - [INFO] - 
--- Epoch 1/50 ---
2025-08-29 15:04:16 - [INFO] - 当前学习率: 0.000010
2025-08-29 15:14:43 - [INFO] - Epoch 1 结果:
2025-08-29 15:14:43 - [INFO] -   训练 - Loss: 0.468665, AUC: 0.9000, Acc: 0.8107
2025-08-29 15:14:43 - [INFO] -   验证 - AUC: 0.9440, Acc: 0.8505
2025-08-29 15:14:43 - [INFO] -   时间 - 训练: 564.9s, 验证: 62.2s, 总计: 627.1s
2025-08-29 15:14:43 - [INFO] -   学习率: 0.000010
2025-08-29 15:14:43 - [INFO] -   *** 新的最佳验证AUC: 0.9440 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 15:14:43 - [INFO] - 
--- Epoch 2/50 ---
2025-08-29 15:14:43 - [INFO] - 当前学习率: 0.000028
2025-08-29 15:25:20 - [INFO] - Epoch 2 结果:
2025-08-29 15:25:20 - [INFO] -   训练 - Loss: 0.359157, AUC: 0.9623, Acc: 0.8994
2025-08-29 15:25:20 - [INFO] -   验证 - AUC: 0.9641, Acc: 0.9015
2025-08-29 15:25:20 - [INFO] -   时间 - 训练: 575.3s, 验证: 61.7s, 总计: 637.1s
2025-08-29 15:25:20 - [INFO] -   学习率: 0.000028
2025-08-29 15:25:20 - [INFO] -   *** 新的最佳验证AUC: 0.9641 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 15:25:20 - [INFO] - 
--- Epoch 3/50 ---
2025-08-29 15:25:20 - [INFO] - 当前学习率: 0.000046
2025-08-29 15:35:58 - [INFO] - Epoch 3 结果:
2025-08-29 15:35:58 - [INFO] -   训练 - Loss: 0.325848, AUC: 0.9748, Acc: 0.9227
2025-08-29 15:35:58 - [INFO] -   验证 - AUC: 0.9649, Acc: 0.8987
2025-08-29 15:35:58 - [INFO] -   时间 - 训练: 576.4s, 验证: 61.7s, 总计: 638.1s
2025-08-29 15:35:58 - [INFO] -   学习率: 0.000046
2025-08-29 15:35:58 - [INFO] -   *** 新的最佳验证AUC: 0.9649 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 15:35:58 - [INFO] - 
--- Epoch 4/50 ---
2025-08-29 15:35:58 - [INFO] - 当前学习率: 0.000064
2025-08-29 15:46:35 - [INFO] - Epoch 4 结果:
2025-08-29 15:46:35 - [INFO] -   训练 - Loss: 0.312973, AUC: 0.9794, Acc: 0.9304
2025-08-29 15:46:35 - [INFO] -   验证 - AUC: 0.9541, Acc: 0.8863
2025-08-29 15:46:35 - [INFO] -   时间 - 训练: 574.7s, 验证: 61.8s, 总计: 636.5s
2025-08-29 15:46:35 - [INFO] -   学习率: 0.000064
2025-08-29 15:46:35 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-08-29 15:46:35 - [INFO] - 
--- Epoch 5/50 ---
2025-08-29 15:46:35 - [INFO] - 当前学习率: 0.000082
2025-08-29 15:57:11 - [INFO] - Epoch 5 结果:
2025-08-29 15:57:11 - [INFO] -   训练 - Loss: 0.307342, AUC: 0.9806, Acc: 0.9355
2025-08-29 15:57:11 - [INFO] -   验证 - AUC: 0.9726, Acc: 0.9101
2025-08-29 15:57:11 - [INFO] -   时间 - 训练: 574.4s, 验证: 61.6s, 总计: 636.0s
2025-08-29 15:57:11 - [INFO] -   学习率: 0.000082
2025-08-29 15:57:11 - [INFO] -   *** 新的最佳验证AUC: 0.9726 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 15:57:11 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_epoch_5.pth
2025-08-29 15:57:11 - [INFO] - 
--- Epoch 6/50 ---
2025-08-29 15:57:11 - [INFO] - 当前学习率: 0.000100
2025-08-29 16:07:47 - [INFO] - Epoch 6 结果:
2025-08-29 16:07:47 - [INFO] -   训练 - Loss: 0.304027, AUC: 0.9821, Acc: 0.9371
2025-08-29 16:07:47 - [INFO] -   验证 - AUC: 0.9760, Acc: 0.9049
2025-08-29 16:07:47 - [INFO] -   时间 - 训练: 574.3s, 验证: 61.8s, 总计: 636.1s
2025-08-29 16:07:47 - [INFO] -   学习率: 0.000100
2025-08-29 16:07:47 - [INFO] -   *** 新的最佳验证AUC: 0.9760 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 16:07:47 - [INFO] - 
--- Epoch 7/50 ---
2025-08-29 16:07:47 - [INFO] - 当前学习率: 0.000100
2025-08-29 16:18:24 - [INFO] - Epoch 7 结果:
2025-08-29 16:18:24 - [INFO] -   训练 - Loss: 0.289400, AUC: 0.9861, Acc: 0.9457
2025-08-29 16:18:24 - [INFO] -   验证 - AUC: 0.9750, Acc: 0.9039
2025-08-29 16:18:24 - [INFO] -   时间 - 训练: 574.5s, 验证: 61.7s, 总计: 636.3s
2025-08-29 16:18:24 - [INFO] -   学习率: 0.000100
2025-08-29 16:18:24 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-08-29 16:18:24 - [INFO] - 
--- Epoch 8/50 ---
2025-08-29 16:18:24 - [INFO] - 当前学习率: 0.000100
2025-08-29 16:29:02 - [INFO] - Epoch 8 结果:
2025-08-29 16:29:02 - [INFO] -   训练 - Loss: 0.283045, AUC: 0.9876, Acc: 0.9498
2025-08-29 16:29:02 - [INFO] -   验证 - AUC: 0.9707, Acc: 0.9202
2025-08-29 16:29:02 - [INFO] -   时间 - 训练: 576.5s, 验证: 61.6s, 总计: 638.2s
2025-08-29 16:29:02 - [INFO] -   学习率: 0.000100
2025-08-29 16:29:02 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-08-29 16:29:02 - [INFO] - 
--- Epoch 9/50 ---
2025-08-29 16:29:02 - [INFO] - 当前学习率: 0.000099
2025-08-29 16:39:38 - [INFO] - Epoch 9 结果:
2025-08-29 16:39:38 - [INFO] -   训练 - Loss: 0.278060, AUC: 0.9887, Acc: 0.9544
2025-08-29 16:39:38 - [INFO] -   验证 - AUC: 0.9766, Acc: 0.8729
2025-08-29 16:39:38 - [INFO] -   时间 - 训练: 574.2s, 验证: 62.0s, 总计: 636.2s
2025-08-29 16:39:38 - [INFO] -   学习率: 0.000099
2025-08-29 16:39:38 - [INFO] -   *** 新的最佳验证AUC: 0.9766 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 16:39:38 - [INFO] - 
--- Epoch 10/50 ---
2025-08-29 16:39:38 - [INFO] - 当前学习率: 0.000098
2025-08-29 16:50:15 - [INFO] - Epoch 10 结果:
2025-08-29 16:50:15 - [INFO] -   训练 - Loss: 0.276197, AUC: 0.9892, Acc: 0.9550
2025-08-29 16:50:15 - [INFO] -   验证 - AUC: 0.9760, Acc: 0.9181
2025-08-29 16:50:15 - [INFO] -   时间 - 训练: 574.6s, 验证: 61.7s, 总计: 636.3s
2025-08-29 16:50:15 - [INFO] -   学习率: 0.000098
2025-08-29 16:50:15 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-08-29 16:50:15 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_epoch_10.pth
2025-08-29 16:50:15 - [INFO] - 
--- Epoch 11/50 ---
2025-08-29 16:50:15 - [INFO] - 当前学习率: 0.000097
2025-08-29 17:00:51 - [INFO] - Epoch 11 结果:
2025-08-29 17:00:51 - [INFO] -   训练 - Loss: 0.267947, AUC: 0.9913, Acc: 0.9596
2025-08-29 17:00:51 - [INFO] -   验证 - AUC: 0.9664, Acc: 0.9067
2025-08-29 17:00:51 - [INFO] -   时间 - 训练: 574.3s, 验证: 61.6s, 总计: 636.0s
2025-08-29 17:00:51 - [INFO] -   学习率: 0.000097
2025-08-29 17:00:51 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-08-29 17:00:51 - [INFO] - 
--- Epoch 12/50 ---
2025-08-29 17:00:51 - [INFO] - 当前学习率: 0.000096
2025-08-29 17:11:34 - [INFO] - Epoch 12 结果:
2025-08-29 17:11:34 - [INFO] -   训练 - Loss: 0.261181, AUC: 0.9929, Acc: 0.9636
2025-08-29 17:11:34 - [INFO] -   验证 - AUC: 0.9739, Acc: 0.9156
2025-08-29 17:11:34 - [INFO] -   时间 - 训练: 566.6s, 验证: 76.4s, 总计: 643.1s
2025-08-29 17:11:34 - [INFO] -   学习率: 0.000096
2025-08-29 17:11:34 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-08-29 17:11:34 - [INFO] - 
--- Epoch 13/50 ---
2025-08-29 17:11:34 - [INFO] - 当前学习率: 0.000094
2025-08-29 17:22:13 - [INFO] - Epoch 13 结果:
2025-08-29 17:22:13 - [INFO] -   训练 - Loss: 0.259557, AUC: 0.9933, Acc: 0.9650
2025-08-29 17:22:13 - [INFO] -   验证 - AUC: 0.9761, Acc: 0.9217
2025-08-29 17:22:13 - [INFO] -   时间 - 训练: 562.5s, 验证: 76.3s, 总计: 638.9s
2025-08-29 17:22:13 - [INFO] -   学习率: 0.000094
2025-08-29 17:22:13 - [INFO] -   验证AUC未改善，连续4轮未提升
2025-08-29 17:22:13 - [INFO] - 
--- Epoch 14/50 ---
2025-08-29 17:22:13 - [INFO] - 当前学习率: 0.000092
2025-08-29 17:32:48 - [INFO] - Epoch 14 结果:
2025-08-29 17:32:48 - [INFO] -   训练 - Loss: 0.258148, AUC: 0.9933, Acc: 0.9658
2025-08-29 17:32:48 - [INFO] -   验证 - AUC: 0.9763, Acc: 0.9221
2025-08-29 17:32:48 - [INFO] -   时间 - 训练: 559.4s, 验证: 75.8s, 总计: 635.2s
2025-08-29 17:32:48 - [INFO] -   学习率: 0.000092
2025-08-29 17:32:48 - [INFO] -   验证AUC未改善，连续5轮未提升
2025-08-29 17:32:48 - [INFO] - 
--- Epoch 15/50 ---
2025-08-29 17:32:48 - [INFO] - 当前学习率: 0.000090
2025-08-29 17:43:21 - [INFO] - Epoch 15 结果:
2025-08-29 17:43:21 - [INFO] -   训练 - Loss: 0.253912, AUC: 0.9942, Acc: 0.9686
2025-08-29 17:43:21 - [INFO] -   验证 - AUC: 0.9769, Acc: 0.9254
2025-08-29 17:43:21 - [INFO] -   时间 - 训练: 557.2s, 验证: 75.7s, 总计: 632.9s
2025-08-29 17:43:21 - [INFO] -   学习率: 0.000090
2025-08-29 17:43:21 - [INFO] -   *** 新的最佳验证AUC: 0.9769 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 17:43:21 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_epoch_15.pth
2025-08-29 17:43:21 - [INFO] - 
--- Epoch 16/50 ---
2025-08-29 17:43:21 - [INFO] - 当前学习率: 0.000088
2025-08-29 17:53:54 - [INFO] - Epoch 16 结果:
2025-08-29 17:53:54 - [INFO] -   训练 - Loss: 0.249629, AUC: 0.9951, Acc: 0.9709
2025-08-29 17:53:54 - [INFO] -   验证 - AUC: 0.9803, Acc: 0.9358
2025-08-29 17:53:54 - [INFO] -   时间 - 训练: 556.9s, 验证: 75.8s, 总计: 632.7s
2025-08-29 17:53:54 - [INFO] -   学习率: 0.000088
2025-08-29 17:53:54 - [INFO] -   *** 新的最佳验证AUC: 0.9803 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 17:53:54 - [INFO] - 
--- Epoch 17/50 ---
2025-08-29 17:53:54 - [INFO] - 当前学习率: 0.000086
2025-08-29 18:04:27 - [INFO] - Epoch 17 结果:
2025-08-29 18:04:27 - [INFO] -   训练 - Loss: 0.249067, AUC: 0.9950, Acc: 0.9713
2025-08-29 18:04:27 - [INFO] -   验证 - AUC: 0.9729, Acc: 0.9184
2025-08-29 18:04:27 - [INFO] -   时间 - 训练: 557.3s, 验证: 75.5s, 总计: 632.9s
2025-08-29 18:04:27 - [INFO] -   学习率: 0.000086
2025-08-29 18:04:27 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-08-29 18:04:27 - [INFO] - 
--- Epoch 18/50 ---
2025-08-29 18:04:27 - [INFO] - 当前学习率: 0.000083
2025-08-29 18:15:00 - [INFO] - Epoch 18 结果:
2025-08-29 18:15:00 - [INFO] -   训练 - Loss: 0.245974, AUC: 0.9956, Acc: 0.9729
2025-08-29 18:15:00 - [INFO] -   验证 - AUC: 0.9758, Acc: 0.9071
2025-08-29 18:15:00 - [INFO] -   时间 - 训练: 557.5s, 验证: 75.8s, 总计: 633.4s
2025-08-29 18:15:00 - [INFO] -   学习率: 0.000083
2025-08-29 18:15:00 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-08-29 18:15:00 - [INFO] - 
--- Epoch 19/50 ---
2025-08-29 18:15:00 - [INFO] - 当前学习率: 0.000081
2025-08-29 18:25:33 - [INFO] - Epoch 19 结果:
2025-08-29 18:25:33 - [INFO] -   训练 - Loss: 0.242233, AUC: 0.9964, Acc: 0.9746
2025-08-29 18:25:33 - [INFO] -   验证 - AUC: 0.9789, Acc: 0.9311
2025-08-29 18:25:33 - [INFO] -   时间 - 训练: 556.6s, 验证: 75.9s, 总计: 632.5s
2025-08-29 18:25:33 - [INFO] -   学习率: 0.000081
2025-08-29 18:25:33 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-08-29 18:25:33 - [INFO] - 
--- Epoch 20/50 ---
2025-08-29 18:25:33 - [INFO] - 当前学习率: 0.000078
2025-08-29 18:36:05 - [INFO] - Epoch 20 结果:
2025-08-29 18:36:05 - [INFO] -   训练 - Loss: 0.240051, AUC: 0.9966, Acc: 0.9764
2025-08-29 18:36:05 - [INFO] -   验证 - AUC: 0.9810, Acc: 0.9324
2025-08-29 18:36:05 - [INFO] -   时间 - 训练: 556.8s, 验证: 75.7s, 总计: 632.6s
2025-08-29 18:36:05 - [INFO] -   学习率: 0.000078
2025-08-29 18:36:05 - [INFO] -   *** 新的最佳验证AUC: 0.9810 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 18:36:05 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_epoch_20.pth
2025-08-29 18:36:05 - [INFO] - 
--- Epoch 21/50 ---
2025-08-29 18:36:05 - [INFO] - 当前学习率: 0.000075
2025-08-29 18:46:38 - [INFO] - Epoch 21 结果:
2025-08-29 18:46:38 - [INFO] -   训练 - Loss: 0.237766, AUC: 0.9970, Acc: 0.9776
2025-08-29 18:46:38 - [INFO] -   验证 - AUC: 0.9787, Acc: 0.9129
2025-08-29 18:46:38 - [INFO] -   时间 - 训练: 556.5s, 验证: 75.8s, 总计: 632.4s
2025-08-29 18:46:38 - [INFO] -   学习率: 0.000075
2025-08-29 18:46:38 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-08-29 18:46:38 - [INFO] - 
--- Epoch 22/50 ---
2025-08-29 18:46:38 - [INFO] - 当前学习率: 0.000072
2025-08-29 18:57:10 - [INFO] - Epoch 22 结果:
2025-08-29 18:57:10 - [INFO] -   训练 - Loss: 0.235491, AUC: 0.9974, Acc: 0.9792
2025-08-29 18:57:10 - [INFO] -   验证 - AUC: 0.9814, Acc: 0.9302
2025-08-29 18:57:10 - [INFO] -   时间 - 训练: 556.5s, 验证: 75.8s, 总计: 632.4s
2025-08-29 18:57:10 - [INFO] -   学习率: 0.000072
2025-08-29 18:57:10 - [INFO] -   *** 新的最佳验证AUC: 0.9814 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 18:57:10 - [INFO] - 
--- Epoch 23/50 ---
2025-08-29 18:57:10 - [INFO] - 当前学习率: 0.000069
2025-08-29 19:07:42 - [INFO] - Epoch 23 结果:
2025-08-29 19:07:42 - [INFO] -   训练 - Loss: 0.232981, AUC: 0.9975, Acc: 0.9810
2025-08-29 19:07:42 - [INFO] -   验证 - AUC: 0.9801, Acc: 0.9303
2025-08-29 19:07:42 - [INFO] -   时间 - 训练: 556.4s, 验证: 75.7s, 总计: 632.2s
2025-08-29 19:07:42 - [INFO] -   学习率: 0.000069
2025-08-29 19:07:42 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-08-29 19:07:42 - [INFO] - 
--- Epoch 24/50 ---
2025-08-29 19:07:42 - [INFO] - 当前学习率: 0.000065
2025-08-29 19:18:15 - [INFO] - Epoch 24 结果:
2025-08-29 19:18:15 - [INFO] -   训练 - Loss: 0.231336, AUC: 0.9978, Acc: 0.9815
2025-08-29 19:18:15 - [INFO] -   验证 - AUC: 0.9771, Acc: 0.9287
2025-08-29 19:18:15 - [INFO] -   时间 - 训练: 556.3s, 验证: 75.7s, 总计: 632.1s
2025-08-29 19:18:15 - [INFO] -   学习率: 0.000065
2025-08-29 19:18:15 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-08-29 19:18:15 - [INFO] - 
--- Epoch 25/50 ---
2025-08-29 19:18:15 - [INFO] - 当前学习率: 0.000062
2025-08-29 19:28:46 - [INFO] - Epoch 25 结果:
2025-08-29 19:28:46 - [INFO] -   训练 - Loss: 0.228364, AUC: 0.9981, Acc: 0.9830
2025-08-29 19:28:46 - [INFO] -   验证 - AUC: 0.9767, Acc: 0.9245
2025-08-29 19:28:46 - [INFO] -   时间 - 训练: 555.9s, 验证: 75.7s, 总计: 631.6s
2025-08-29 19:28:46 - [INFO] -   学习率: 0.000062
2025-08-29 19:28:46 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-08-29 19:28:46 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_epoch_25.pth
2025-08-29 19:28:46 - [INFO] - 
--- Epoch 26/50 ---
2025-08-29 19:28:46 - [INFO] - 当前学习率: 0.000059
2025-08-29 19:39:17 - [INFO] - Epoch 26 结果:
2025-08-29 19:39:17 - [INFO] -   训练 - Loss: 0.226319, AUC: 0.9983, Acc: 0.9845
2025-08-29 19:39:17 - [INFO] -   验证 - AUC: 0.9781, Acc: 0.9327
2025-08-29 19:39:17 - [INFO] -   时间 - 训练: 555.8s, 验证: 75.3s, 总计: 631.2s
2025-08-29 19:39:17 - [INFO] -   学习率: 0.000059
2025-08-29 19:39:17 - [INFO] -   验证AUC未改善，连续4轮未提升
2025-08-29 19:39:17 - [INFO] - 
--- Epoch 27/50 ---
2025-08-29 19:39:17 - [INFO] - 当前学习率: 0.000055
2025-08-29 19:49:49 - [INFO] - Epoch 27 结果:
2025-08-29 19:49:49 - [INFO] -   训练 - Loss: 0.225440, AUC: 0.9984, Acc: 0.9854
2025-08-29 19:49:49 - [INFO] -   验证 - AUC: 0.9777, Acc: 0.9309
2025-08-29 19:49:49 - [INFO] -   时间 - 训练: 569.5s, 验证: 61.6s, 总计: 631.1s
2025-08-29 19:49:49 - [INFO] -   学习率: 0.000055
2025-08-29 19:49:49 - [INFO] -   验证AUC未改善，连续5轮未提升
2025-08-29 19:49:49 - [INFO] - 
--- Epoch 28/50 ---
2025-08-29 19:49:49 - [INFO] - 当前学习率: 0.000052
2025-08-29 20:00:18 - [INFO] - Epoch 28 结果:
2025-08-29 20:00:18 - [INFO] -   训练 - Loss: 0.223565, AUC: 0.9987, Acc: 0.9858
2025-08-29 20:00:18 - [INFO] -   验证 - AUC: 0.9763, Acc: 0.9151
2025-08-29 20:00:18 - [INFO] -   时间 - 训练: 568.4s, 验证: 61.2s, 总计: 629.7s
2025-08-29 20:00:18 - [INFO] -   学习率: 0.000052
2025-08-29 20:00:18 - [INFO] -   验证AUC未改善，连续6轮未提升
2025-08-29 20:00:18 - [INFO] - 
--- Epoch 29/50 ---
2025-08-29 20:00:18 - [INFO] - 当前学习率: 0.000048
2025-08-29 20:10:55 - [INFO] - Epoch 29 结果:
2025-08-29 20:10:55 - [INFO] -   训练 - Loss: 0.221419, AUC: 0.9989, Acc: 0.9871
2025-08-29 20:10:55 - [INFO] -   验证 - AUC: 0.9806, Acc: 0.9301
2025-08-29 20:10:55 - [INFO] -   时间 - 训练: 573.7s, 验证: 62.6s, 总计: 636.4s
2025-08-29 20:10:55 - [INFO] -   学习率: 0.000048
2025-08-29 20:10:55 - [INFO] -   验证AUC未改善，连续7轮未提升
2025-08-29 20:10:55 - [INFO] - 
--- Epoch 30/50 ---
2025-08-29 20:10:55 - [INFO] - 当前学习率: 0.000045
2025-08-29 20:21:35 - [INFO] - Epoch 30 结果:
2025-08-29 20:21:35 - [INFO] -   训练 - Loss: 0.220392, AUC: 0.9989, Acc: 0.9880
2025-08-29 20:21:35 - [INFO] -   验证 - AUC: 0.9835, Acc: 0.9350
2025-08-29 20:21:35 - [INFO] -   时间 - 训练: 564.3s, 验证: 76.2s, 总计: 640.5s
2025-08-29 20:21:35 - [INFO] -   学习率: 0.000045
2025-08-29 20:21:35 - [INFO] -   *** 新的最佳验证AUC: 0.9835 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth ***
2025-08-29 20:21:35 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_epoch_30.pth
2025-08-29 20:21:35 - [INFO] - 
--- Epoch 31/50 ---
2025-08-29 20:21:35 - [INFO] - 当前学习率: 0.000041
2025-08-29 20:32:16 - [INFO] - Epoch 31 结果:
2025-08-29 20:32:16 - [INFO] -   训练 - Loss: 0.217079, AUC: 0.9992, Acc: 0.9901
2025-08-29 20:32:16 - [INFO] -   验证 - AUC: 0.9763, Acc: 0.9347
2025-08-29 20:32:16 - [INFO] -   时间 - 训练: 564.6s, 验证: 76.1s, 总计: 640.8s
2025-08-29 20:32:16 - [INFO] -   学习率: 0.000041
2025-08-29 20:32:16 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-08-29 20:32:16 - [INFO] - 
--- Epoch 32/50 ---
2025-08-29 20:32:16 - [INFO] - 当前学习率: 0.000038
2025-08-29 20:42:50 - [INFO] - Epoch 32 结果:
2025-08-29 20:42:50 - [INFO] -   训练 - Loss: 0.215650, AUC: 0.9993, Acc: 0.9906
2025-08-29 20:42:50 - [INFO] -   验证 - AUC: 0.9776, Acc: 0.9317
2025-08-29 20:42:50 - [INFO] -   时间 - 训练: 557.8s, 验证: 75.7s, 总计: 633.5s
2025-08-29 20:42:50 - [INFO] -   学习率: 0.000038
2025-08-29 20:42:50 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-08-29 20:42:50 - [INFO] - 
--- Epoch 33/50 ---
2025-08-29 20:42:50 - [INFO] - 当前学习率: 0.000035
2025-08-29 20:53:23 - [INFO] - Epoch 33 结果:
2025-08-29 20:53:23 - [INFO] -   训练 - Loss: 0.214512, AUC: 0.9994, Acc: 0.9911
2025-08-29 20:53:23 - [INFO] -   验证 - AUC: 0.9675, Acc: 0.9268
2025-08-29 20:53:23 - [INFO] -   时间 - 训练: 558.0s, 验证: 75.7s, 总计: 633.7s
2025-08-29 20:53:23 - [INFO] -   学习率: 0.000035
2025-08-29 20:53:23 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-08-29 20:53:23 - [INFO] - 
--- Epoch 34/50 ---
2025-08-29 20:53:23 - [INFO] - 当前学习率: 0.000031
2025-08-29 21:03:57 - [INFO] - Epoch 34 结果:
2025-08-29 21:03:57 - [INFO] -   训练 - Loss: 0.212920, AUC: 0.9995, Acc: 0.9920
2025-08-29 21:03:57 - [INFO] -   验证 - AUC: 0.9797, Acc: 0.9343
2025-08-29 21:03:57 - [INFO] -   时间 - 训练: 557.9s, 验证: 75.6s, 总计: 633.6s
2025-08-29 21:03:57 - [INFO] -   学习率: 0.000031
2025-08-29 21:03:57 - [INFO] -   验证AUC未改善，连续4轮未提升
2025-08-29 21:03:57 - [INFO] - 
--- Epoch 35/50 ---
2025-08-29 21:03:57 - [INFO] - 当前学习率: 0.000028
2025-08-29 21:14:34 - [INFO] - Epoch 35 结果:
2025-08-29 21:14:34 - [INFO] -   训练 - Loss: 0.211826, AUC: 0.9996, Acc: 0.9927
2025-08-29 21:14:34 - [INFO] -   验证 - AUC: 0.9798, Acc: 0.9330
2025-08-29 21:14:34 - [INFO] -   时间 - 训练: 561.2s, 验证: 76.0s, 总计: 637.2s
2025-08-29 21:14:34 - [INFO] -   学习率: 0.000028
2025-08-29 21:14:34 - [INFO] -   验证AUC未改善，连续5轮未提升
2025-08-29 21:14:34 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_epoch_35.pth
2025-08-29 21:14:34 - [INFO] - 
--- Epoch 36/50 ---
2025-08-29 21:14:34 - [INFO] - 当前学习率: 0.000025
2025-08-29 21:25:14 - [INFO] - Epoch 36 结果:
2025-08-29 21:25:14 - [INFO] -   训练 - Loss: 0.210037, AUC: 0.9996, Acc: 0.9937
2025-08-29 21:25:14 - [INFO] -   验证 - AUC: 0.9790, Acc: 0.9372
2025-08-29 21:25:14 - [INFO] -   时间 - 训练: 563.6s, 验证: 76.2s, 总计: 639.9s
2025-08-29 21:25:14 - [INFO] -   学习率: 0.000025
2025-08-29 21:25:14 - [INFO] -   验证AUC未改善，连续6轮未提升
2025-08-29 21:25:14 - [INFO] - 
--- Epoch 37/50 ---
2025-08-29 21:25:14 - [INFO] - 当前学习率: 0.000022
2025-08-29 21:35:53 - [INFO] - Epoch 37 结果:
2025-08-29 21:35:53 - [INFO] -   训练 - Loss: 0.209245, AUC: 0.9996, Acc: 0.9941
2025-08-29 21:35:53 - [INFO] -   验证 - AUC: 0.9814, Acc: 0.9365
2025-08-29 21:35:53 - [INFO] -   时间 - 训练: 563.0s, 验证: 75.6s, 总计: 638.6s
2025-08-29 21:35:53 - [INFO] -   学习率: 0.000022
2025-08-29 21:35:53 - [INFO] -   验证AUC未改善，连续7轮未提升
2025-08-29 21:35:53 - [INFO] - 
--- Epoch 38/50 ---
2025-08-29 21:35:53 - [INFO] - 当前学习率: 0.000019
2025-08-29 21:46:27 - [INFO] - Epoch 38 结果:
2025-08-29 21:46:27 - [INFO] -   训练 - Loss: 0.207942, AUC: 0.9997, Acc: 0.9950
2025-08-29 21:46:27 - [INFO] -   验证 - AUC: 0.9811, Acc: 0.9357
2025-08-29 21:46:27 - [INFO] -   时间 - 训练: 557.9s, 验证: 75.6s, 总计: 633.6s
2025-08-29 21:46:27 - [INFO] -   学习率: 0.000019
2025-08-29 21:46:27 - [INFO] -   验证AUC未改善，连续8轮未提升
2025-08-29 21:46:27 - [INFO] - 达到早停条件 (patience=8)，在epoch 38停止训练
2025-08-29 21:46:27 - [INFO] - ============================================================
2025-08-29 21:46:27 - [INFO] - 训练完成!
2025-08-29 21:46:27 - [INFO] - 最佳验证AUC: 0.9835
2025-08-29 21:46:27 - [INFO] - 总训练时间: 6.70 小时
2025-08-29 21:46:27 - [INFO] - 最佳模型保存位置: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42\swin_tiny_best.pth
2025-08-29 21:46:27 - [INFO] - ============================================================
2025-08-29 21:46:27 - [INFO] - 训练结束 - 最佳验证AUC: 0.9835
2025-08-29 21:46:27 - [INFO] - 
============================================================
2025-08-29 21:46:27 - [INFO] - 开始测试阶段 - 纯净性能（无H.264噪声）
2025-08-29 21:46:27 - [INFO] - ============================================================
2025-08-29 21:47:43 - [INFO] - 纯净测试结果:
2025-08-29 21:47:43 - [INFO] -   - 测试AUC: 0.9858
2025-08-29 21:47:43 - [INFO] -   - 测试准确率: 0.9373
2025-08-29 21:47:43 - [INFO] -   - 测试时间: 76.53秒
2025-08-29 21:47:43 - [INFO] -   - 测试样本数: 15000
2025-08-29 21:47:43 - [INFO] - 
============================================================
2025-08-29 21:47:43 - [INFO] - 开始测试阶段 - 噪声鲁棒性（含H.264噪声）
2025-08-29 21:47:43 - [INFO] - ============================================================
2025-08-29 21:49:00 - [INFO] - 噪声测试结果:
2025-08-29 21:49:00 - [INFO] -   - 测试AUC (噪声): 0.9384
2025-08-29 21:49:00 - [INFO] -   - 测试准确率 (噪声): 0.8637
2025-08-29 21:49:00 - [INFO] -   - 测试时间: 76.21秒
2025-08-29 21:49:00 - [INFO] -   - 鲁棒性评估 (AUC下降): 0.0474
2025-08-29 21:49:00 - [INFO] - 
================================================================================
2025-08-29 21:49:00 - [INFO] - 程序执行完成
2025-08-29 21:49:00 - [INFO] - 结束时间: 2025-08-29 21:49:00
2025-08-29 21:49:00 - [INFO] - 总执行时间: 6.75 小时
2025-08-29 21:49:00 - [INFO] - 
最终结果总结:
2025-08-29 21:49:00 - [INFO] -   - 最佳验证AUC: 0.9835
2025-08-29 21:49:00 - [INFO] -   - 纯净测试AUC: 0.9858
2025-08-29 21:49:00 - [INFO] -   - 噪声测试AUC: 0.9384
2025-08-29 21:49:00 - [INFO] -   - 噪声鲁棒性: 95.2%
2025-08-29 21:49:00 - [INFO] - ================================================================================

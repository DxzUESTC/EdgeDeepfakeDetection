2025-09-04 17:12:48 - [INFO] - 日志文件保存位置: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer\train_log_20250904_171248.txt
2025-09-04 17:12:48 - [INFO] - ================================================================================
2025-09-04 17:12:48 - [INFO] - Swin Transformer V2 Base Deepfake Detection Training
2025-09-04 17:12:48 - [INFO] - 开始时间: 2025-09-04 17:12:48
2025-09-04 17:12:48 - [INFO] - ================================================================================
2025-09-04 17:12:48 - [INFO] - 路径配置:
2025-09-04 17:12:48 - [INFO] -   - 基础目录: D:\09_Project\EdgeDeepfakeDetection
2025-09-04 17:12:48 - [INFO] -   - 元数据文件: D:\09_Project\EdgeDeepfakeDetection\data\datasets\metadata\video_metadata_c23.csv
2025-09-04 17:12:48 - [INFO] -   - 人脸数据目录: D:\09_Project\EdgeDeepfakeDetection\data\preprocessed\faces_256
2025-09-04 17:12:48 - [INFO] -   - 日志保存目录: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\swin_transformer
2025-09-04 17:12:48 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_swinv2_base
2025-09-04 17:12:48 - [INFO] - 训练参数配置:
2025-09-04 17:12:48 - [INFO] -   - 随机种子: 42
2025-09-04 17:12:48 - [INFO] -   - 批次大小: 16
2025-09-04 17:12:48 - [INFO] -   - 工作进程数: 4
2025-09-04 17:12:48 - [INFO] -   - 训练轮数: 75
2025-09-04 17:12:48 - [INFO] -   - 早停patience: 12
2025-09-04 17:12:48 - [INFO] -   - 学习率: 5e-05
2025-09-04 17:12:48 - [INFO] -   - 权重衰减: 0.05
2025-09-04 17:12:48 - [INFO] - 所有路径检查通过 ✓
2025-09-04 17:12:48 - [INFO] - 正在加载数据集...
2025-09-04 17:12:49 - [INFO] - 数据集加载成功:
2025-09-04 17:12:49 - [INFO] -   - 训练集样本数: 70000
2025-09-04 17:12:49 - [INFO] -   - 验证集样本数: 15000
2025-09-04 17:12:49 - [INFO] -   - 测试集样本数: 15000
2025-09-04 17:12:49 - [INFO] - 标签分布统计:
2025-09-04 17:12:49 - [INFO] -   - 训练集 Real: 35000, Fake: 35000
2025-09-04 17:12:49 - [INFO] -   - 验证集 Real: 7500, Fake: 7500
2025-09-04 17:12:49 - [INFO] -   - 测试集 Real: 7500, Fake: 7500
2025-09-04 17:12:49 - [INFO] - 数据加载器配置: batch_size=16, num_workers=4
2025-09-04 17:12:49 - [INFO] - 正在验证数据加载...
2025-09-04 17:13:17 - [INFO] - 样本批次形状: inputs=torch.Size([16, 3, 256, 256]), labels=torch.Size([16])
2025-09-04 17:13:17 - [INFO] - 输入数据统计: mean=-0.0321, std=0.9555
2025-09-04 17:13:17 - [INFO] - 输入数据范围: min=-2.1179, max=2.6400
2025-09-04 17:13:17 - [INFO] - 标签分布: tensor([9, 7])
2025-09-04 17:13:17 - [INFO] - ✓ 数据验证完成
2025-09-04 17:13:17 - [INFO] - 正在初始化Swin Transformer V2 Base模型...
2025-09-04 17:13:22 - [INFO] - 已加载预训练的Swin Transformer V2 Base模型
2025-09-04 17:13:22 - [INFO] - 模型结构: swinv2_base_window16_256 + Dropout(0.1)
2025-09-04 17:13:22 - [INFO] - 模型详细信息:
2025-09-04 17:13:22 - [INFO] -   - 架构: Swin Transformer V2 (Base)
2025-09-04 17:13:22 - [INFO] -   - 补丁大小: 4x4
2025-09-04 17:13:22 - [INFO] -   - 窗口大小: 16x16 (相比V1的7x7窗口更大)
2025-09-04 17:13:22 - [INFO] -   - 输入分辨率: 256x256
2025-09-04 17:13:22 - [INFO] -   - 嵌入维度: 128
2025-09-04 17:13:22 - [INFO] -   - 层数: [2,2,18,2] (4个阶段)
2025-09-04 17:13:22 - [INFO] -   - 注意力头数: [4,8,16,32]
2025-09-04 17:13:22 - [INFO] -   - 参数量: ~88M (Base版本)
2025-09-04 17:13:22 - [INFO] -   - V2改进: 相对位置编码、残差后归一化、缩放余弦注意力
2025-09-04 17:13:22 - [INFO] - 验证预训练权重加载状态...
2025-09-04 17:13:22 - [INFO] - 第一层权重统计: mean=0.000055, std=0.053234
2025-09-04 17:13:22 - [INFO] - ✓ 权重已正确初始化
2025-09-04 17:13:22 - [INFO] - 模型架构详情:
2025-09-04 17:13:22 - [INFO] -   - 总参数数量: 86,895,866
2025-09-04 17:13:22 - [INFO] -   - 可训练参数数量: 86,895,866
2025-09-04 17:13:22 - [INFO] -   - 模型大小估计: 331.5 MB (FP32)
2025-09-04 17:13:22 - [INFO] -   - V2相对V1改进: 相对位置编码优化、残差后归一化、缩放余弦注意力机制
2025-09-04 17:13:22 - [INFO] - 使用设备: cuda
2025-09-04 17:13:22 - [INFO] - CUDA设备信息: NVIDIA GeForce RTX 3070 Ti Laptop GPU
2025-09-04 17:13:22 - [INFO] - GPU内存: 8.0 GB
2025-09-04 17:13:23 - [INFO] - 优化器配置:
2025-09-04 17:13:23 - [INFO] -   - 优化器: AdamW
2025-09-04 17:13:23 - [INFO] -   - 初始学习率: 5e-05 (针对V2 Base调低)
2025-09-04 17:13:23 - [INFO] -   - 最小学习率: 1e-5 (提高以保持后期优化能力)
2025-09-04 17:13:23 - [INFO] -   - 权重衰减: 0.05
2025-09-04 17:13:23 - [INFO] -   - 调度器: Warmup(2) + CosineAnnealingLR(T_max=75)
2025-09-04 17:13:23 - [INFO] -   - 损失函数: CrossEntropyLoss (移除label_smoothing追求更低Loss)
2025-09-04 17:13:23 - [INFO] -   - 分类头Dropout: 0.1 (降低以增强拟合能力)
2025-09-04 17:13:23 - [INFO] -   - 批次大小调整: 16 (为V2 Base减小以适应GPU内存)
2025-09-04 17:13:23 - [INFO] - ============================================================
2025-09-04 17:13:23 - [INFO] - 开始训练模型
2025-09-04 17:13:23 - [INFO] - ============================================================
2025-09-04 17:13:23 - [INFO] - 模型总参数数量: 86,895,866
2025-09-04 17:13:23 - [INFO] - 可训练参数数量: 86,895,866
2025-09-04 17:13:23 - [INFO] - 训练配置:
2025-09-04 17:13:23 - [INFO] -   - 总epochs: 75
2025-09-04 17:13:23 - [INFO] -   - 早停patience: 12
2025-09-04 17:13:23 - [INFO] -   - 学习率: 5e-06
2025-09-04 17:13:23 - [INFO] -   - 权重衰减: 0.05
2025-09-04 17:13:23 - [INFO] -   - 批次大小: 16
2025-09-04 17:13:23 - [INFO] -   - 训练样本数: 70000
2025-09-04 17:13:23 - [INFO] -   - 验证样本数: 15000
2025-09-04 17:13:23 - [INFO] -   - 设备: cuda:0
2025-09-04 17:13:23 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\swin_transformer\seed42_swinv2_base
2025-09-04 17:13:23 - [INFO] -   - PyTorch随机种子: 42
2025-09-04 17:13:23 - [INFO] -   - CUDA随机种子: 42
2025-09-04 17:13:23 - [INFO] -   - CUDNN确定性: True
2025-09-04 17:13:23 - [INFO] -   - CUDNN基准测试: False
2025-09-04 17:13:23 - [INFO] - Swin Transformer V2 Base 使用端到端训练，无需冻结层
2025-09-04 17:13:23 - [INFO] - 
--- Epoch 1/75 ---
2025-09-04 17:13:23 - [INFO] - 当前学习率: 0.000005

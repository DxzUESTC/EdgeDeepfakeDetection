2025-08-29 11:06:23 - [INFO] - 日志文件保存位置: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\mobilenetv3\train_log_20250829_110623.txt
2025-08-29 11:06:23 - [INFO] - ================================================================================
2025-08-29 11:06:23 - [INFO] - MobileNetV3 Deepfake Detection Training
2025-08-29 11:06:23 - [INFO] - 开始时间: 2025-08-29 11:06:23
2025-08-29 11:06:23 - [INFO] - ================================================================================
2025-08-29 11:06:23 - [INFO] - 路径配置:
2025-08-29 11:06:23 - [INFO] -   - 基础目录: D:\09_Project\EdgeDeepfakeDetection
2025-08-29 11:06:23 - [INFO] -   - 元数据文件: D:\09_Project\EdgeDeepfakeDetection\data\datasets\metadata\video_metadata_c23.csv
2025-08-29 11:06:23 - [INFO] -   - 人脸数据目录: D:\09_Project\EdgeDeepfakeDetection\data\preprocessed\faces_224
2025-08-29 11:06:23 - [INFO] -   - 日志保存目录: D:\09_Project\EdgeDeepfakeDetection\experiments\baseline\mobilenetv3
2025-08-29 11:06:23 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42
2025-08-29 11:06:23 - [INFO] - 训练参数配置:
2025-08-29 11:06:23 - [INFO] -   - 随机种子: 42
2025-08-29 11:06:23 - [INFO] -   - 批次大小: 128
2025-08-29 11:06:23 - [INFO] -   - 工作进程数: 4
2025-08-29 11:06:23 - [INFO] -   - 训练轮数: 50
2025-08-29 11:06:23 - [INFO] -   - 早停patience: 5
2025-08-29 11:06:23 - [INFO] -   - 学习率: 0.001
2025-08-29 11:06:23 - [INFO] -   - 权重衰减: 0.0001
2025-08-29 11:06:23 - [INFO] - 所有路径检查通过 ✓
2025-08-29 11:06:23 - [INFO] - 正在加载数据集...
2025-08-29 11:06:24 - [INFO] - 数据集加载成功:
2025-08-29 11:06:24 - [INFO] -   - 训练集样本数: 70000
2025-08-29 11:06:24 - [INFO] -   - 验证集样本数: 15000
2025-08-29 11:06:24 - [INFO] -   - 测试集样本数: 15000
2025-08-29 11:06:24 - [INFO] - 标签分布统计:
2025-08-29 11:06:24 - [INFO] -   - 训练集 Real: 35000, Fake: 35000
2025-08-29 11:06:24 - [INFO] -   - 验证集 Real: 7500, Fake: 7500
2025-08-29 11:06:24 - [INFO] -   - 测试集 Real: 7500, Fake: 7500
2025-08-29 11:06:24 - [INFO] - 数据加载器配置: batch_size=128, num_workers=4
2025-08-29 11:06:24 - [INFO] - 正在初始化模型...
2025-08-29 11:06:24 - [INFO] - 已加载预训练的MobileNetV3-Small模型
2025-08-29 11:06:24 - [INFO] - 已修改分类器层，添加Dropout(0.2)和2分类输出
2025-08-29 11:06:24 - [INFO] - 使用设备: cuda
2025-08-29 11:06:24 - [INFO] - CUDA设备信息: NVIDIA GeForce RTX 3070 Ti Laptop GPU
2025-08-29 11:06:24 - [INFO] - GPU内存: 8.0 GB
2025-08-29 11:06:24 - [INFO] - 优化器配置:
2025-08-29 11:06:24 - [INFO] -   - 优化器: Adam
2025-08-29 11:06:24 - [INFO] -   - 初始学习率: 1e-3
2025-08-29 11:06:24 - [INFO] -   - 权重衰减: 1e-4
2025-08-29 11:06:24 - [INFO] -   - 调度器: CosineAnnealingLR (T_max=50)
2025-08-29 11:06:24 - [INFO] -   - 损失函数: CrossEntropyLoss
2025-08-29 11:06:24 - [INFO] - ============================================================
2025-08-29 11:06:24 - [INFO] - 开始训练模型
2025-08-29 11:06:24 - [INFO] - ============================================================
2025-08-29 11:06:24 - [INFO] - 模型总参数数量: 1,519,906
2025-08-29 11:06:24 - [INFO] - 可训练参数数量: 1,519,906
2025-08-29 11:06:24 - [INFO] - 训练配置:
2025-08-29 11:06:24 - [INFO] -   - 总epochs: 50
2025-08-29 11:06:24 - [INFO] -   - 早停patience: 5
2025-08-29 11:06:24 - [INFO] -   - 学习率: 0.001
2025-08-29 11:06:24 - [INFO] -   - 权重衰减: 0.0001
2025-08-29 11:06:24 - [INFO] -   - 批次大小: 128
2025-08-29 11:06:24 - [INFO] -   - 训练样本数: 70000
2025-08-29 11:06:24 - [INFO] -   - 验证样本数: 15000
2025-08-29 11:06:24 - [INFO] -   - 设备: cuda:0
2025-08-29 11:06:24 - [INFO] -   - 模型保存目录: D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42
2025-08-29 11:06:24 - [INFO] -   - PyTorch随机种子: 42
2025-08-29 11:06:24 - [INFO] -   - CUDA随机种子: 42
2025-08-29 11:06:24 - [INFO] -   - CUDNN确定性: True
2025-08-29 11:06:24 - [INFO] -   - CUDNN基准测试: False
2025-08-29 11:06:24 - [INFO] - 特征提取层已冻结，前5个epoch只训练分类器
2025-08-29 11:06:24 - [INFO] - 
--- Epoch 1/50 ---
2025-08-29 11:06:24 - [INFO] - 当前学习率: 0.001000
2025-08-29 11:08:03 - [INFO] - Epoch 1 结果:
2025-08-29 11:08:03 - [INFO] -   训练 - Loss: 0.620199, AUC: 0.7115, Acc: 0.6528
2025-08-29 11:08:03 - [INFO] -   验证 - AUC: 0.7514, Acc: 0.6427
2025-08-29 11:08:03 - [INFO] -   时间 - 训练: 74.4s, 验证: 24.1s, 总计: 98.6s
2025-08-29 11:08:03 - [INFO] -   学习率: 0.001000
2025-08-29 11:08:03 - [INFO] -   *** 新的最佳验证AUC: 0.7514 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth ***
2025-08-29 11:08:03 - [INFO] - 
--- Epoch 2/50 ---
2025-08-29 11:08:03 - [INFO] - 当前学习率: 0.000999
2025-08-29 11:09:39 - [INFO] - Epoch 2 结果:
2025-08-29 11:09:39 - [INFO] -   训练 - Loss: 0.586444, AUC: 0.7538, Acc: 0.6851
2025-08-29 11:09:39 - [INFO] -   验证 - AUC: 0.7727, Acc: 0.7023
2025-08-29 11:09:39 - [INFO] -   时间 - 训练: 72.2s, 验证: 23.9s, 总计: 96.1s
2025-08-29 11:09:39 - [INFO] -   学习率: 0.000999
2025-08-29 11:09:39 - [INFO] -   *** 新的最佳验证AUC: 0.7727 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth ***
2025-08-29 11:09:39 - [INFO] - 
--- Epoch 3/50 ---
2025-08-29 11:09:39 - [INFO] - 当前学习率: 0.000996
2025-08-29 11:11:16 - [INFO] - Epoch 3 结果:
2025-08-29 11:11:16 - [INFO] -   训练 - Loss: 0.562191, AUC: 0.7791, Acc: 0.7066
2025-08-29 11:11:16 - [INFO] -   验证 - AUC: 0.7799, Acc: 0.6979
2025-08-29 11:11:16 - [INFO] -   时间 - 训练: 72.2s, 验证: 24.8s, 总计: 97.0s
2025-08-29 11:11:16 - [INFO] -   学习率: 0.000996
2025-08-29 11:11:16 - [INFO] -   *** 新的最佳验证AUC: 0.7799 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth ***
2025-08-29 11:11:16 - [INFO] - 
--- Epoch 4/50 ---
2025-08-29 11:11:16 - [INFO] - 当前学习率: 0.000991
2025-08-29 11:13:03 - [INFO] - Epoch 4 结果:
2025-08-29 11:13:03 - [INFO] -   训练 - Loss: 0.541484, AUC: 0.7987, Acc: 0.7211
2025-08-29 11:13:03 - [INFO] -   验证 - AUC: 0.7856, Acc: 0.7035
2025-08-29 11:13:03 - [INFO] -   时间 - 训练: 81.8s, 验证: 25.1s, 总计: 107.0s
2025-08-29 11:13:03 - [INFO] -   学习率: 0.000991
2025-08-29 11:13:03 - [INFO] -   *** 新的最佳验证AUC: 0.7856 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth ***
2025-08-29 11:13:03 - [INFO] - 
--- Epoch 5/50 ---
2025-08-29 11:13:03 - [INFO] - 当前学习率: 0.000984
2025-08-29 11:14:50 - [INFO] - Epoch 5 结果:
2025-08-29 11:14:50 - [INFO] -   训练 - Loss: 0.525787, AUC: 0.8126, Acc: 0.7330
2025-08-29 11:14:50 - [INFO] -   验证 - AUC: 0.7977, Acc: 0.7225
2025-08-29 11:14:50 - [INFO] -   时间 - 训练: 81.9s, 验证: 25.1s, 总计: 107.1s
2025-08-29 11:14:50 - [INFO] -   学习率: 0.000984
2025-08-29 11:14:50 - [INFO] -   *** 新的最佳验证AUC: 0.7977 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth ***
2025-08-29 11:14:50 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_epoch_5.pth
2025-08-29 11:14:50 - [INFO] - 
--- Epoch 6/50 ---
2025-08-29 11:14:50 - [INFO] - 当前学习率: 0.000976
2025-08-29 11:14:50 - [INFO] - 特征提取层已解冻，开始端到端微调
2025-08-29 11:14:50 - [INFO] - 当前可训练参数数量: 1,519,906
2025-08-29 11:16:57 - [INFO] - Epoch 6 结果:
2025-08-29 11:16:57 - [INFO] -   训练 - Loss: 0.295502, AUC: 0.9455, Acc: 0.8713
2025-08-29 11:16:57 - [INFO] -   验证 - AUC: 0.9451, Acc: 0.8704
2025-08-29 11:16:57 - [INFO] -   时间 - 训练: 101.0s, 验证: 25.3s, 总计: 126.4s
2025-08-29 11:16:57 - [INFO] -   学习率: 0.000976
2025-08-29 11:16:57 - [INFO] -   *** 新的最佳验证AUC: 0.9451 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth ***
2025-08-29 11:16:57 - [INFO] - 
--- Epoch 7/50 ---
2025-08-29 11:16:57 - [INFO] - 当前学习率: 0.000965
2025-08-29 11:19:02 - [INFO] - Epoch 7 结果:
2025-08-29 11:19:02 - [INFO] -   训练 - Loss: 0.183291, AUC: 0.9787, Acc: 0.9266
2025-08-29 11:19:02 - [INFO] -   验证 - AUC: 0.9467, Acc: 0.8663
2025-08-29 11:19:02 - [INFO] -   时间 - 训练: 100.7s, 验证: 25.0s, 总计: 125.8s
2025-08-29 11:19:02 - [INFO] -   学习率: 0.000965
2025-08-29 11:19:02 - [INFO] -   *** 新的最佳验证AUC: 0.9467 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth ***
2025-08-29 11:19:02 - [INFO] - 
--- Epoch 8/50 ---
2025-08-29 11:19:02 - [INFO] - 当前学习率: 0.000952
2025-08-29 11:21:08 - [INFO] - Epoch 8 结果:
2025-08-29 11:21:08 - [INFO] -   训练 - Loss: 0.149189, AUC: 0.9856, Acc: 0.9419
2025-08-29 11:21:08 - [INFO] -   验证 - AUC: 0.9536, Acc: 0.8462
2025-08-29 11:21:08 - [INFO] -   时间 - 训练: 100.5s, 验证: 25.1s, 总计: 125.7s
2025-08-29 11:21:08 - [INFO] -   学习率: 0.000952
2025-08-29 11:21:08 - [INFO] -   *** 新的最佳验证AUC: 0.9536 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth ***
2025-08-29 11:21:08 - [INFO] - 
--- Epoch 9/50 ---
2025-08-29 11:21:08 - [INFO] - 当前学习率: 0.000938
2025-08-29 11:23:14 - [INFO] - Epoch 9 结果:
2025-08-29 11:23:14 - [INFO] -   训练 - Loss: 0.129807, AUC: 0.9892, Acc: 0.9491
2025-08-29 11:23:14 - [INFO] -   验证 - AUC: 0.9250, Acc: 0.7833
2025-08-29 11:23:14 - [INFO] -   时间 - 训练: 100.6s, 验证: 25.1s, 总计: 125.8s
2025-08-29 11:23:14 - [INFO] -   学习率: 0.000938
2025-08-29 11:23:14 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-08-29 11:23:14 - [INFO] - 
--- Epoch 10/50 ---
2025-08-29 11:23:14 - [INFO] - 当前学习率: 0.000922
2025-08-29 11:25:20 - [INFO] - Epoch 10 结果:
2025-08-29 11:25:20 - [INFO] -   训练 - Loss: 0.119290, AUC: 0.9908, Acc: 0.9545
2025-08-29 11:25:20 - [INFO] -   验证 - AUC: 0.9513, Acc: 0.8776
2025-08-29 11:25:20 - [INFO] -   时间 - 训练: 100.8s, 验证: 25.2s, 总计: 126.0s
2025-08-29 11:25:20 - [INFO] -   学习率: 0.000922
2025-08-29 11:25:20 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-08-29 11:25:20 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_epoch_10.pth
2025-08-29 11:25:20 - [INFO] - 
--- Epoch 11/50 ---
2025-08-29 11:25:20 - [INFO] - 当前学习率: 0.000905
2025-08-29 11:27:26 - [INFO] - Epoch 11 结果:
2025-08-29 11:27:26 - [INFO] -   训练 - Loss: 0.111648, AUC: 0.9919, Acc: 0.9580
2025-08-29 11:27:26 - [INFO] -   验证 - AUC: 0.9471, Acc: 0.8419
2025-08-29 11:27:26 - [INFO] -   时间 - 训练: 100.7s, 验证: 25.3s, 总计: 126.0s
2025-08-29 11:27:26 - [INFO] -   学习率: 0.000905
2025-08-29 11:27:26 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-08-29 11:27:26 - [INFO] - 
--- Epoch 12/50 ---
2025-08-29 11:27:26 - [INFO] - 当前学习率: 0.000885
2025-08-29 11:29:31 - [INFO] - Epoch 12 结果:
2025-08-29 11:29:31 - [INFO] -   训练 - Loss: 0.105675, AUC: 0.9927, Acc: 0.9594
2025-08-29 11:29:31 - [INFO] -   验证 - AUC: 0.9633, Acc: 0.8599
2025-08-29 11:29:31 - [INFO] -   时间 - 训练: 99.7s, 验证: 24.9s, 总计: 124.6s
2025-08-29 11:29:31 - [INFO] -   学习率: 0.000885
2025-08-29 11:29:31 - [INFO] -   *** 新的最佳验证AUC: 0.9633 - 模型已保存到 D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth ***
2025-08-29 11:29:31 - [INFO] - 
--- Epoch 13/50 ---
2025-08-29 11:29:31 - [INFO] - 当前学习率: 0.000864
2025-08-29 11:31:36 - [INFO] - Epoch 13 结果:
2025-08-29 11:31:36 - [INFO] -   训练 - Loss: 0.101396, AUC: 0.9933, Acc: 0.9613
2025-08-29 11:31:36 - [INFO] -   验证 - AUC: 0.9343, Acc: 0.8574
2025-08-29 11:31:36 - [INFO] -   时间 - 训练: 100.0s, 验证: 24.9s, 总计: 125.0s
2025-08-29 11:31:36 - [INFO] -   学习率: 0.000864
2025-08-29 11:31:36 - [INFO] -   验证AUC未改善，连续1轮未提升
2025-08-29 11:31:36 - [INFO] - 
--- Epoch 14/50 ---
2025-08-29 11:31:36 - [INFO] - 当前学习率: 0.000842
2025-08-29 11:33:40 - [INFO] - Epoch 14 结果:
2025-08-29 11:33:40 - [INFO] -   训练 - Loss: 0.097478, AUC: 0.9937, Acc: 0.9634
2025-08-29 11:33:40 - [INFO] -   验证 - AUC: 0.9590, Acc: 0.8878
2025-08-29 11:33:40 - [INFO] -   时间 - 训练: 99.3s, 验证: 24.9s, 总计: 124.3s
2025-08-29 11:33:40 - [INFO] -   学习率: 0.000842
2025-08-29 11:33:40 - [INFO] -   验证AUC未改善，连续2轮未提升
2025-08-29 11:33:40 - [INFO] - 
--- Epoch 15/50 ---
2025-08-29 11:33:40 - [INFO] - 当前学习率: 0.000819
2025-08-29 11:35:45 - [INFO] - Epoch 15 结果:
2025-08-29 11:35:45 - [INFO] -   训练 - Loss: 0.094379, AUC: 0.9941, Acc: 0.9636
2025-08-29 11:35:45 - [INFO] -   验证 - AUC: 0.9622, Acc: 0.8912
2025-08-29 11:35:45 - [INFO] -   时间 - 训练: 99.9s, 验证: 24.9s, 总计: 124.9s
2025-08-29 11:35:45 - [INFO] -   学习率: 0.000819
2025-08-29 11:35:45 - [INFO] -   验证AUC未改善，连续3轮未提升
2025-08-29 11:35:45 - [INFO] -   Checkpoint已保存: D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_epoch_15.pth
2025-08-29 11:35:45 - [INFO] - 
--- Epoch 16/50 ---
2025-08-29 11:35:45 - [INFO] - 当前学习率: 0.000794
2025-08-29 11:37:50 - [INFO] - Epoch 16 结果:
2025-08-29 11:37:50 - [INFO] -   训练 - Loss: 0.090095, AUC: 0.9946, Acc: 0.9654
2025-08-29 11:37:50 - [INFO] -   验证 - AUC: 0.9590, Acc: 0.8941
2025-08-29 11:37:50 - [INFO] -   时间 - 训练: 99.6s, 验证: 25.0s, 总计: 124.6s
2025-08-29 11:37:50 - [INFO] -   学习率: 0.000794
2025-08-29 11:37:50 - [INFO] -   验证AUC未改善，连续4轮未提升
2025-08-29 11:37:50 - [INFO] - 
--- Epoch 17/50 ---
2025-08-29 11:37:50 - [INFO] - 当前学习率: 0.000768
2025-08-29 11:39:47 - [INFO] - Epoch 17 结果:
2025-08-29 11:39:47 - [INFO] -   训练 - Loss: 0.083500, AUC: 0.9955, Acc: 0.9677
2025-08-29 11:39:47 - [INFO] -   验证 - AUC: 0.9560, Acc: 0.8771
2025-08-29 11:39:47 - [INFO] -   时间 - 训练: 94.2s, 验证: 23.7s, 总计: 117.9s
2025-08-29 11:39:47 - [INFO] -   学习率: 0.000768
2025-08-29 11:39:47 - [INFO] -   验证AUC未改善，连续5轮未提升
2025-08-29 11:39:47 - [INFO] - 达到早停条件 (patience=5)，在epoch 17停止训练
2025-08-29 11:39:47 - [INFO] - ============================================================
2025-08-29 11:39:47 - [INFO] - 训练完成!
2025-08-29 11:39:47 - [INFO] - 最佳验证AUC: 0.9633
2025-08-29 11:39:47 - [INFO] - 总训练时间: 0.56 小时
2025-08-29 11:39:47 - [INFO] - 最佳模型保存位置: D:\09_Project\EdgeDeepfakeDetection\models\baseline\mobilenetv3\seed42\mobilenetv3_best.pth
2025-08-29 11:39:47 - [INFO] - ============================================================
2025-08-29 11:39:47 - [INFO] - 训练结束 - 最佳验证AUC: 0.9633
2025-08-29 11:39:47 - [INFO] - 
============================================================
2025-08-29 11:39:47 - [INFO] - 开始测试阶段 - 纯净性能（无H.264噪声）
2025-08-29 11:39:47 - [INFO] - ============================================================
2025-08-29 11:40:11 - [INFO] - 纯净测试结果:
2025-08-29 11:40:11 - [INFO] -   - 测试AUC: 0.9608
2025-08-29 11:40:11 - [INFO] -   - 测试准确率: 0.8683
2025-08-29 11:40:11 - [INFO] -   - 测试时间: 24.05秒
2025-08-29 11:40:11 - [INFO] -   - 测试样本数: 15000
2025-08-29 11:40:11 - [INFO] - 
============================================================
2025-08-29 11:40:11 - [INFO] - 开始测试阶段 - 噪声鲁棒性（含H.264噪声）
2025-08-29 11:40:11 - [INFO] - ============================================================
2025-08-29 11:40:38 - [INFO] - 噪声测试结果:
2025-08-29 11:40:38 - [INFO] -   - 测试AUC (噪声): 0.8915
2025-08-29 11:40:38 - [INFO] -   - 测试准确率 (噪声): 0.8072
2025-08-29 11:40:38 - [INFO] -   - 测试时间: 26.58秒
2025-08-29 11:40:38 - [INFO] -   - 鲁棒性评估 (AUC下降): 0.0692
2025-08-29 11:40:38 - [INFO] - 
================================================================================
2025-08-29 11:40:38 - [INFO] - 程序执行完成
2025-08-29 11:40:38 - [INFO] - 结束时间: 2025-08-29 11:40:38
2025-08-29 11:40:38 - [INFO] - 总执行时间: 0.57 小时
2025-08-29 11:40:38 - [INFO] - 
最终结果总结:
2025-08-29 11:40:38 - [INFO] -   - 最佳验证AUC: 0.9633
2025-08-29 11:40:38 - [INFO] -   - 纯净测试AUC: 0.9608
2025-08-29 11:40:38 - [INFO] -   - 噪声测试AUC: 0.8915
2025-08-29 11:40:38 - [INFO] -   - 噪声鲁棒性: 92.8%
2025-08-29 11:40:38 - [INFO] - ================================================================================
